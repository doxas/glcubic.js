function matIV(){this.create=function(){return new Float32Array(16)},this.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},this.multiply=function(t,r,n){var a=t[0],i=t[1],e=t[2],s=t[3],h=t[4],u=t[5],o=t[6],c=t[7],f=t[8],v=t[9],M=t[10],l=t[11],p=t[12],y=t[13],A=t[14],w=t[15],I=r[0],q=r[1],P=r[2],m=r[3],V=r[4],d=r[5],b=r[6],g=r[7],x=r[8],F=r[9],k=r[10],z=r[11],B=r[12],j=r[13],C=r[14],D=r[15];return n[0]=I*a+q*h+P*f+m*p,n[1]=I*i+q*u+P*v+m*y,n[2]=I*e+q*o+P*M+m*A,n[3]=I*s+q*c+P*l+m*w,n[4]=V*a+d*h+b*f+g*p,n[5]=V*i+d*u+b*v+g*y,n[6]=V*e+d*o+b*M+g*A,n[7]=V*s+d*c+b*l+g*w,n[8]=x*a+F*h+k*f+z*p,n[9]=x*i+F*u+k*v+z*y,n[10]=x*e+F*o+k*M+z*A,n[11]=x*s+F*c+k*l+z*w,n[12]=B*a+j*h+C*f+D*p,n[13]=B*i+j*u+C*v+D*y,n[14]=B*e+j*o+C*M+D*A,n[15]=B*s+j*c+C*l+D*w,n},this.scale=function(t,r,n){return n[0]=t[0]*r[0],n[1]=t[1]*r[0],n[2]=t[2]*r[0],n[3]=t[3]*r[0],n[4]=t[4]*r[1],n[5]=t[5]*r[1],n[6]=t[6]*r[1],n[7]=t[7]*r[1],n[8]=t[8]*r[2],n[9]=t[9]*r[2],n[10]=t[10]*r[2],n[11]=t[11]*r[2],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},this.translate=function(t,r,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12],n[13]=t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13],n[14]=t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14],n[15]=t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15],n},this.rotate=function(t,r,n,a){var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);if(!i)return null;var e=n[0],s=n[1],h=n[2];1!=i&&(i=1/i,e*=i,s*=i,h*=i);var u=Math.sin(r),o=Math.cos(r),c=1-o,f=t[0],v=t[1],M=t[2],l=t[3],p=t[4],y=t[5],A=t[6],w=t[7],I=t[8],q=t[9],P=t[10],m=t[11],V=e*e*c+o,d=s*e*c+h*u,b=h*e*c-s*u,g=e*s*c-h*u,x=s*s*c+o,F=h*s*c+e*u,k=e*h*c+s*u,z=s*h*c-e*u,B=h*h*c+o;return r?t!=a&&(a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]):a=t,a[0]=f*V+p*d+I*b,a[1]=v*V+y*d+q*b,a[2]=M*V+A*d+P*b,a[3]=l*V+w*d+m*b,a[4]=f*g+p*x+I*F,a[5]=v*g+y*x+q*F,a[6]=M*g+A*x+P*F,a[7]=l*g+w*x+m*F,a[8]=f*k+p*z+I*B,a[9]=v*k+y*z+q*B,a[10]=M*k+A*z+P*B,a[11]=l*k+w*z+m*B,a},this.lookAt=function(t,r,n,a){var i=t[0],e=t[1],s=t[2],h=n[0],u=n[1],o=n[2],c=r[0],f=r[1],v=r[2];if(i==c&&e==f&&s==v)return this.identity(a);var M,l,p,y,A,w,I,q,P,m;return I=i-r[0],q=e-r[1],P=s-r[2],m=1/Math.sqrt(I*I+q*q+P*P),I*=m,q*=m,P*=m,M=u*P-o*q,l=o*I-h*P,p=h*q-u*I,m=Math.sqrt(M*M+l*l+p*p),m?(m=1/m,M*=m,l*=m,p*=m):(M=0,l=0,p=0),y=q*p-P*l,A=P*M-I*p,w=I*l-q*M,m=Math.sqrt(y*y+A*A+w*w),m?(m=1/m,y*=m,A*=m,w*=m):(y=0,A=0,w=0),a[0]=M,a[1]=y,a[2]=I,a[3]=0,a[4]=l,a[5]=A,a[6]=q,a[7]=0,a[8]=p,a[9]=w,a[10]=P,a[11]=0,a[12]=-(M*i+l*e+p*s),a[13]=-(y*i+A*e+w*s),a[14]=-(I*i+q*e+P*s),a[15]=1,a},this.perspective=function(t,r,n,a,i){var e=n*Math.tan(t*Math.PI/360),s=e*r,h=2*s,u=2*e,o=a-n;return i[0]=2*n/h,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*n/u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-(a+n)/o,i[11]=-1,i[12]=0,i[13]=0,i[14]=-(a*n*2)/o,i[15]=0,i},this.ortho=function(t,r,n,a,i,e,s){var h=r-t,u=n-a,o=e-i;return s[0]=2/h,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/o,s[11]=0,s[12]=-(t+r)/h,s[13]=-(n+a)/u,s[14]=-(e+i)/o,s[15]=1,s},this.transpose=function(t,r){return r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15],r},this.inverse=function(t,r){var n=t[0],a=t[1],i=t[2],e=t[3],s=t[4],h=t[5],u=t[6],o=t[7],c=t[8],f=t[9],v=t[10],M=t[11],l=t[12],p=t[13],y=t[14],A=t[15],w=n*h-a*s,I=n*u-i*s,q=n*o-e*s,P=a*u-i*h,m=a*o-e*h,V=i*o-e*u,d=c*p-f*l,b=c*y-v*l,g=c*A-M*l,x=f*y-v*p,F=f*A-M*p,k=v*A-M*y,z=1/(w*k-I*F+q*x+P*g-m*b+V*d);return r[0]=(h*k-u*F+o*x)*z,r[1]=(-a*k+i*F-e*x)*z,r[2]=(p*V-y*m+A*P)*z,r[3]=(-f*V+v*m-M*P)*z,r[4]=(-s*k+u*g-o*b)*z,r[5]=(n*k-i*g+e*b)*z,r[6]=(-l*V+y*q-A*I)*z,r[7]=(c*V-v*q+M*I)*z,r[8]=(s*F-h*g+o*d)*z,r[9]=(-n*F+a*g-e*d)*z,r[10]=(l*m-p*q+A*w)*z,r[11]=(-c*m+f*q-M*w)*z,r[12]=(-s*x+h*b-u*d)*z,r[13]=(n*x-a*b+i*d)*z,r[14]=(-l*P+p*I-y*w)*z,r[15]=(c*P-f*I+v*w)*z,r}}function qtnIV(){this.create=function(){return new Float32Array(4)},this.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},this.inverse=function(t,r){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},this.normalize=function(t){var r=t[0],n=t[1],a=t[2],i=t[3],e=Math.sqrt(r*r+n*n+a*a+i*i);return 0===e?(t[0]=0,t[1]=0,t[2]=0,t[3]=0):(e=1/e,t[0]=r*e,t[1]=n*e,t[2]=a*e,t[3]=i*e),t},this.multiply=function(t,r,n){var a=t[0],i=t[1],e=t[2],s=t[3],h=r[0],u=r[1],o=r[2],c=r[3];return n[0]=a*c+s*h+i*o-e*u,n[1]=i*c+s*u+e*h-a*o,n[2]=e*c+s*o+a*u-i*h,n[3]=s*c-a*h-i*u-e*o,n},this.rotate=function(t,r,n){var a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(!a)return null;var i=r[0],e=r[1],s=r[2];1!=a&&(a=1/a,i*=a,e*=a,s*=a);var h=Math.sin(.5*t);return n[0]=i*h,n[1]=e*h,n[2]=s*h,n[3]=Math.cos(.5*t),n},this.toVecIII=function(t,r,n){var a=this.create(),i=this.create(),e=this.create();return this.inverse(r,e),a[0]=t[0],a[1]=t[1],a[2]=t[2],this.multiply(e,a,i),this.multiply(i,r,e),n[0]=e[0],n[1]=e[1],n[2]=e[2],n},this.toMatIV=function(t,r){var n=t[0],a=t[1],i=t[2],e=t[3],s=n+n,h=a+a,u=i+i,o=n*s,c=n*h,f=n*u,v=a*h,M=a*u,l=i*u,p=e*s,y=e*h,A=e*u;return r[0]=1-(v+l),r[1]=c-A,r[2]=f+y,r[3]=0,r[4]=c+A,r[5]=1-(o+l),r[6]=M-p,r[7]=0,r[8]=f-y,r[9]=M+p,r[10]=1-(o+v),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},this.slerp=function(t,r,n,a){var i=t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3],e=1-i*i;if(0>=e)a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3];else if(e=Math.sqrt(e),Math.abs(e)<1e-4)a[0]=.5*t[0]+.5*r[0],a[1]=.5*t[1]+.5*r[1],a[2]=.5*t[2]+.5*r[2],a[3]=.5*t[3]+.5*r[3];else{var s=Math.acos(i),h=s*n,u=Math.sin(s-h)/e,o=Math.sin(h)/e;a[0]=t[0]*u+r[0]*o,a[1]=t[1]*u+r[1]*o,a[2]=t[2]*u+r[2]*o,a[3]=t[3]*u+r[3]*o}return a}}function torus(t,r,n,a,i){var e,s,h,u=new Array,o=new Array,c=new Array,f=new Array,v=new Array;for(e=0;t>=e;e++){var M=2*Math.PI/t*e,l=Math.cos(M),p=Math.sin(M);for(s=0;r>=s;s++){var y=2*Math.PI/r*s,A=(l*n+a)*Math.cos(y),w=p*n,I=(l*n+a)*Math.sin(y),q=l*Math.cos(y),P=l*Math.sin(y);h=i?i:hsva(360/r*s,1,1,1);var m=1/r*s,V=1/t*e+.5;V>1&&(V-=1),V=1-V,u.push(A,w,I),o.push(q,p,P),c.push(h[0],h[1],h[2],h[3]),f.push(m,V)}}for(e=0;t>e;e++)for(s=0;r>s;s++)M=(r+1)*e+s,v.push(M,M+r+1,M+1),v.push(M+r+1,M+r+2,M+1);return{p:u,n:o,c:c,t:f,i:v}}function sphere(t,r,n,a){var i,e,s,h=new Array,u=new Array,o=new Array,c=new Array,f=new Array;for(i=0;t>=i;i++){var v=Math.PI/t*i,M=Math.cos(v),l=Math.sin(v);for(e=0;r>=e;e++){var p=2*Math.PI/r*e,y=l*n*Math.cos(p),A=M*n,w=l*n*Math.sin(p),I=l*Math.cos(p),q=l*Math.sin(p);s=a?a:hsva(360/t*i,1,1,1),h.push(y,A,w),u.push(I,M,q),o.push(s[0],s[1],s[2],s[3]),c.push(1-1/r*e,1/t*i)}}for(v=0,i=0;t>i;i++)for(e=0;r>e;e++)v=(r+1)*i+e,f.push(v,v+1,v+r+2),f.push(v,v+r+2,v+r+1);return{p:h,n:u,c:o,t:c,i:f}}function cube(t,r){for(var n,a=.5*t,i=[-a,-a,a,a,-a,a,a,a,a,-a,a,a,-a,-a,-a,-a,a,-a,a,a,-a,a,-a,-a,-a,a,-a,-a,a,a,a,a,a,a,a,-a,-a,-a,-a,a,-a,-a,a,-a,a,-a,-a,a,a,-a,-a,a,a,-a,a,a,a,a,-a,a,-a,-a,-a,-a,-a,a,-a,a,a,-a,a,-a],e=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],s=new Array,h=0;h<i.length/3;h++)n=r?r:hsva(360/i.length/3*h,1,1,1),s.push(n[0],n[1],n[2],n[3]);var u=[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],o=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{p:i,n:e,c:s,t:u,i:o}}function hsva(t,r,n,a){if(!(r>1||n>1||a>1)){var i=t%360,e=Math.floor(i/60),s=i/60-e,h=n*(1-r),u=n*(1-r*s),o=n*(1-r*(1-s)),c=new Array;if(!r>0&&0>!r)c.push(n,n,n,a);else{var f=new Array(n,u,h,h,o,n),v=new Array(o,n,n,u,h,h),M=new Array(h,h,o,n,n,u);c.push(f[e],v[e],M[e],a)}return c}}function vector(){alert("vector")}function matrix(){alert("matrix")}function quaternion(){alert("quaternion")}var PI=3.141592653589793,PI2=1.5707963267948966,PI4=.7853981633974483,BPI=6.283185307179586;