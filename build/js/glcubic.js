!function(e){function t(n){if(r[n])return r[n].exports;var l=r[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,t),l.l=!0,l.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=5)}([function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){if(n(this,e),this.ctx=null,this.comp=null,this.bgmGain=null,this.soundGain=null,this.src=null,"undefined"==typeof AudioContext&&"undefined"==typeof webkitAudioContext)throw new Error("not found AudioContext");"undefined"!=typeof AudioContext?this.ctx=new AudioContext:this.ctx=new webkitAudioContext,this.comp=this.ctx.createDynamicsCompressor(),this.comp.connect(this.ctx.destination),this.bgmGain=this.ctx.createGain(),this.bgmGain.connect(this.comp),this.bgmGain.gain.setValueAtTime(t,0),this.soundGain=this.ctx.createGain(),this.soundGain.connect(this.comp),this.soundGain.gain.setValueAtTime(r,0),this.src=[]}return l(e,[{key:"load",value:function(e,t,r,n,l){var i=this.ctx,a=n?this.bgmGain:this.soundGain,u=this.src;u[t]=null;var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Pragma","no-cache"),s.setRequestHeader("Cache-Control","no-cache"),s.responseType="arraybuffer",s.onload=function(){i.decodeAudioData(s.response,function(s){u[t]=new o(i,a,s,r,n),u[t].loaded=!0,console.log("%c◆%c audio number: %c"+t+"%c, audio loaded: %c"+e,"color: crimson","","color: blue","","color: goldenrod"),l()},function(e){console.log(e)})},s.send()}},{key:"loadComplete",value:function(){var e=void 0,t=void 0;for(t=!0,e=0;e<this.src.length;e++)t=t&&null!=this.src[e]&&this.src[e].loaded;return t}}]),e}();t.default=i;var o=function(){function e(t,r,l,i,o){n(this,e),this.ctx=t,this.gain=r,this.audioBuffer=l,this.bufferSource=[],this.activeBufferSource=0,this.loop=i,this.loaded=!1,this.fftLoop=16,this.update=!1,this.background=o,this.node=this.ctx.createScriptProcessor(2048,1,1),this.analyser=this.ctx.createAnalyser(),this.analyser.smoothingTimeConstant=.8,this.analyser.fftSize=2*this.fftLoop,this.onData=new Uint8Array(this.analyser.frequencyBinCount)}return l(e,[{key:"play",value:function(){function e(e){i.update&&(i.update=!1,i.analyser.getByteFrequencyData(i.onData))}var t=this,r=void 0,n=void 0,l=void 0,i=this;if(r=this.bufferSource.length,l=-1,r>0){for(n=0;n<r;n++)if(!this.bufferSource[n].playnow){this.bufferSource[n]=null,this.bufferSource[n]=this.ctx.createBufferSource(),l=n;break}l<0&&(this.bufferSource[this.bufferSource.length]=this.ctx.createBufferSource(),l=this.bufferSource.length-1)}else this.bufferSource[0]=this.ctx.createBufferSource(),l=0;this.activeBufferSource=l,this.bufferSource[l].buffer=this.audioBuffer,this.bufferSource[l].loop=this.loop,this.bufferSource[l].playbackRate.value=1,this.loop||(this.bufferSource[l].onended=function(){t.stop(0),t.playnow=!1}),this.background&&(this.bufferSource[l].connect(this.analyser),this.analyser.connect(this.node),this.node.connect(this.ctx.destination),this.node.onaudioprocess=function(t){e(t)}),this.bufferSource[l].connect(this.gain),this.bufferSource[l].start(0),this.bufferSource[l].playnow=!0}},{key:"stop",value:function(){this.bufferSource[this.activeBufferSource].stop(0),this.playnow=!1}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(){i(this,e),this.Wrapper=u,this.Element=s,this.Slider=c,this.Checkbox=h,this.Select=f,this.Spin=d,this.Color=E};t.default=a;var u=function(){function e(){var t=this;i(this,e),this.element=document.createElement("div"),this.element.style.position="absolute",this.element.style.top="0px",this.element.style.right="0px",this.element.style.width="340px",this.element.style.height="100%",this.element.style.transition="right 0.8s cubic-bezier(0, 0, 0, 1.0)",this.wrapper=document.createElement("div"),this.wrapper.style.backgroundColor="rgba(64, 64, 64, 0.5)",this.wrapper.style.height="100%",this.wrapper.style.overflow="auto",this.toggle=document.createElement("div"),this.toggle.className="visible",this.toggle.textContent="▶",this.toggle.style.fontSize="18px",this.toggle.style.lineHeight="32px",this.toggle.style.color="rgba(240, 240, 240, 0.5)",this.toggle.style.backgroundColor="rgba(32, 32, 32, 0.5)",this.toggle.style.border="1px solid rgba(240, 240, 240, 0.2)",this.toggle.style.borderRadius="25px",this.toggle.style.boxShadow="0px 0px 2px 2px rgba(8, 8, 8, 0.8)",this.toggle.style.position="absolute",this.toggle.style.top="20px",this.toggle.style.right="360px",this.toggle.style.width="32px",this.toggle.style.height="32px",this.toggle.style.cursor="pointer",this.toggle.style.transform="rotate(0deg)",this.toggle.style.transition="transform 0.5s cubic-bezier(0, 0, 0, 1.0)",this.element.appendChild(this.toggle),this.element.appendChild(this.wrapper),this.toggle.addEventListener("click",function(){t.toggle.classList.toggle("visible"),t.toggle.classList.contains("visible")?(t.element.style.right="0px",t.toggle.style.transform="rotate(0deg)"):(t.element.style.right="-340px",t.toggle.style.transform="rotate(-180deg)")})}return o(e,[{key:"getElement",value:function(){return this.element}},{key:"append",value:function(e){this.wrapper.appendChild(e)}}]),e}(),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";i(this,e),this.element=document.createElement("div"),this.element.style.fontSize="small",this.element.style.textAlign="center",this.element.style.width="320px",this.element.style.height="30px",this.element.style.lineHeight="30px",this.element.style.display="flex",this.element.style.flexDirection="row",this.element.style.justifyContent="flex-start",this.label=document.createElement("span"),this.label.textContent=t,this.label.style.color="#222",this.label.style.textShadow="0px 0px 5px white",this.label.style.display="inline-block",this.label.style.margin="auto 5px",this.label.style.width="100px",this.label.style.overflow="hidden",this.element.appendChild(this.label),this.value=document.createElement("span"),this.value.style.backgroundColor="rgba(0, 0, 0, 0.25)",this.value.style.color="whitesmoke",this.value.style.fontSize="x-small",this.value.style.textShadow="0px 0px 5px black",this.value.style.display="inline-block",this.value.style.margin="auto 5px",this.value.style.width="50px",this.value.style.overflow="hidden",this.element.appendChild(this.value),this.control=null,this.text=t,this.listeners={}}return o(e,[{key:"add",value:function(e,t){null!=this.control&&null!=e&&null!=t&&"[object String]"===Object.prototype.toString.call(e)&&"[object Function]"===Object.prototype.toString.call(t)&&(this.listeners[e]=t)}},{key:"emit",value:function(e,t){null!=this.control&&this.listeners.hasOwnProperty(e)&&this.listeners[e](t,this)}},{key:"remove",value:function(){null!=this.control&&this.listeners.hasOwnProperty(type)&&(this.listeners[type]=null,delete this.listeners[type])}},{key:"setValue",value:function(e){this.value.textContent=e,this.control.value=e}},{key:"getValue",value:function(){return this.control.value}},{key:"getControl",value:function(){return this.control}},{key:"getText",value:function(){return this.text}},{key:"getElement",value:function(){return this.element}}]),e}(),c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;i(this,t);var u=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.control=document.createElement("input"),u.control.setAttribute("type","range"),u.control.setAttribute("min",l),u.control.setAttribute("max",o),u.control.setAttribute("step",a),u.control.value=r,u.control.style.margin="auto",u.control.style.verticalAlign="middle",u.element.appendChild(u.control),u.setValue(u.control.value),u.control.addEventListener("input",function(e){u.emit("input",e),u.setValue(u.control.value)},!1),u}return l(t,e),o(t,[{key:"setMin",value:function(e){this.control.setAttribute("min",e)}},{key:"setMax",value:function(e){this.control.setAttribute("max",e)}},{key:"setStep",value:function(e){this.control.setAttribute("step",e)}}]),t}(s),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.control=document.createElement("input"),l.control.setAttribute("type","checkbox"),l.control.checked=r,l.control.style.margin="auto",l.control.style.verticalAlign="middle",l.element.appendChild(l.control),l.setValue(l.control.checked),l.control.addEventListener("change",function(e){l.emit("change",e),l.setValue(l.control.checked)},!1),l}return l(t,e),o(t,[{key:"setValue",value:function(e){this.value.textContent=e,this.control.checked=e}},{key:"getValue",value:function(){return this.control.checked}}]),t}(s),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.control=document.createElement("select"),r.map(function(e){var t=new Option(e,e);o.control.add(t)}),o.control.selectedIndex=l,o.control.style.width="130px",o.control.style.margin="auto",o.control.style.verticalAlign="middle",o.element.appendChild(o.control),o.setValue(o.control.value),o.control.addEventListener("change",function(e){o.emit("change",e),o.setValue(o.control.value)},!1),o}return l(t,e),o(t,[{key:"setSelectedIndex",value:function(e){this.control.selectedIndex=e}},{key:"getSelectedIndex",value:function(){return this.control.selectedIndex}}]),t}(s),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1;i(this,t);var u=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return u.control=document.createElement("input"),u.control.setAttribute("type","number"),u.control.setAttribute("min",l),u.control.setAttribute("max",o),u.control.setAttribute("step",a),u.control.value=r,u.control.style.margin="auto",u.control.style.verticalAlign="middle",u.element.appendChild(u.control),u.setValue(u.control.value),u.control.addEventListener("input",function(e){u.emit("input",e),u.setValue(u.control.value)},!1),u}return l(t,e),o(t,[{key:"setMin",value:function(e){this.control.setAttribute("min",e)}},{key:"setMax",value:function(e){this.control.setAttribute("max",e)}},{key:"setStep",value:function(e){this.control.setAttribute("step",e)}}]),t}(s),E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000";i(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));l.container=document.createElement("div"),l.container.style.lineHeight="0",l.container.style.margin="2px auto",l.container.style.width="100px",l.label=document.createElement("div"),l.label.style.margin="0px",l.label.style.width="calc(100% - 2px)",l.label.style.height="24px",l.label.style.border="1px solid whitesmoke",l.label.style.boxShadow="0px 0px 0px 1px #222",l.control=document.createElement("canvas"),l.control.style.margin="0px",l.control.style.display="none",l.control.width=100,l.control.height=100,l.element.appendChild(l.container),l.container.appendChild(l.label),l.container.appendChild(l.control),l.ctx=l.control.getContext("2d");for(var o=l.ctx.createLinearGradient(0,0,l.control.width,0),a=["#ff0000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000"],u=0,s=a.length;u<s;++u)o.addColorStop(u/(s-1),a[u]);l.ctx.fillStyle=o,l.ctx.fillRect(0,0,l.control.width,l.control.height),o=l.ctx.createLinearGradient(0,0,0,l.control.height),a=["rgba(255, 255, 255, 1.0)","rgba(255, 255, 255, 0.0)","rgba(0, 0, 0, 0.0)","rgba(0, 0, 0, 1.0)"];for(var c=0,h=a.length;c<h;++c)o.addColorStop(c/(h-1),a[c]);return l.ctx.fillStyle=o,l.ctx.fillRect(0,0,l.control.width,l.control.height),l.colorValue=r,l.tempColorValue=null,l.setValue(r),l.container.addEventListener("mouseover",function(){l.control.style.display="block",l.tempColorValue=l.colorValue}),l.container.addEventListener("mouseout",function(){l.control.style.display="none",null!=l.tempColorValue&&(l.setValue(l.tempColorValue),l.tempColorValue=null)}),l.control.addEventListener("mousemove",function(e){var t=l.ctx.getImageData(e.offsetX,e.offsetY,1,1),r=l.getColor8bitString(t.data);l.setValue(r)}),l.control.addEventListener("click",function(e){var t=l.ctx.getImageData(e.offsetX,e.offsetY,1,1);e.currentTarget.value=l.getColor8bitString(t.data),l.tempColorValue=null,l.control.style.display="none",l.emit("change",e)},!1),l}return l(t,e),o(t,[{key:"setValue",value:function(e){this.value.textContent=e,this.colorValue=e,this.container.style.backgroundColor=this.colorValue}},{key:"getValue",value:function(){return this.colorValue}},{key:"getFloatValue",value:function(){return this.getColorFloatArray(this.colorValue)}},{key:"getColor8bitString",value:function(e){return"#"+this.zeroPadding(e[0].toString(16),2)+this.zeroPadding(e[1].toString(16),2)+this.zeroPadding(e[2].toString(16),2)}},{key:"getColorFloatArray",value:function(e){if(null==e||"[object String]"!==Object.prototype.toString.call(e))return null;if(-1===e.search(/^#+[\d|a-f|A-F]+$/))return null;var t=e.replace("#","");if(3!==t.length&&6!==t.length)return null;var r=t.length/3;return[parseInt(e.substr(1,r),16)/255,parseInt(e.substr(1+r,r),16)/255,parseInt(e.substr(1+2*r,r),16)/255]}},{key:"zeroPadding",value:function(e,t){return(new Array(t).join("0")+e).slice(-t)}}]),t}(s)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(){n(this,e),this.Mat4=o,this.Vec3=a,this.Vec2=u,this.Qtn=s};t.default=i;var o=function(){function e(){n(this,e)}return l(e,null,[{key:"create",value:function(){return new Float32Array(16)}},{key:"identity",value:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"multiply",value:function(t,r,n){var l=n;null==n&&(l=e.create());var i=t[0],o=t[1],a=t[2],u=t[3],s=t[4],c=t[5],h=t[6],f=t[7],d=t[8],E=t[9],v=t[10],g=t[11],T=t[12],p=t[13],y=t[14],R=t[15],m=r[0],b=r[1],x=r[2],_=r[3],A=r[4],M=r[5],U=r[6],F=r[7],k=r[8],P=r[9],S=r[10],C=r[11],w=r[12],L=r[13],I=r[14],D=r[15];return l[0]=m*i+b*s+x*d+_*T,l[1]=m*o+b*c+x*E+_*p,l[2]=m*a+b*h+x*v+_*y,l[3]=m*u+b*f+x*g+_*R,l[4]=A*i+M*s+U*d+F*T,l[5]=A*o+M*c+U*E+F*p,l[6]=A*a+M*h+U*v+F*y,l[7]=A*u+M*f+U*g+F*R,l[8]=k*i+P*s+S*d+C*T,l[9]=k*o+P*c+S*E+C*p,l[10]=k*a+P*h+S*v+C*y,l[11]=k*u+P*f+S*g+C*R,l[12]=w*i+L*s+I*d+D*T,l[13]=w*o+L*c+I*E+D*p,l[14]=w*a+L*h+I*v+D*y,l[15]=w*u+L*f+I*g+D*R,l}},{key:"scale",value:function(t,r,n){var l=n;return null==n&&(l=e.create()),l[0]=t[0]*r[0],l[1]=t[1]*r[0],l[2]=t[2]*r[0],l[3]=t[3]*r[0],l[4]=t[4]*r[1],l[5]=t[5]*r[1],l[6]=t[6]*r[1],l[7]=t[7]*r[1],l[8]=t[8]*r[2],l[9]=t[9]*r[2],l[10]=t[10]*r[2],l[11]=t[11]*r[2],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l}},{key:"translate",value:function(t,r,n){var l=n;return null==n&&(l=e.create()),l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12],l[13]=t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13],l[14]=t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14],l[15]=t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15],l}},{key:"rotate",value:function(t,r,n,l){var i=l;null==l&&(i=e.create());var o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);if(!o)return null;var a=n[0],u=n[1],s=n[2];1!=o&&(o=1/o,a*=o,u*=o,s*=o);var c=Math.sin(r),h=Math.cos(r),f=1-h,d=t[0],E=t[1],v=t[2],g=t[3],T=t[4],p=t[5],y=t[6],R=t[7],m=t[8],b=t[9],x=t[10],_=t[11],A=a*a*f+h,M=u*a*f+s*c,U=s*a*f-u*c,F=a*u*f-s*c,k=u*u*f+h,P=s*u*f+a*c,S=a*s*f+u*c,C=u*s*f-a*c,w=s*s*f+h;return r?t!=i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=d*A+T*M+m*U,i[1]=E*A+p*M+b*U,i[2]=v*A+y*M+x*U,i[3]=g*A+R*M+_*U,i[4]=d*F+T*k+m*P,i[5]=E*F+p*k+b*P,i[6]=v*F+y*k+x*P,i[7]=g*F+R*k+_*P,i[8]=d*S+T*C+m*w,i[9]=E*S+p*C+b*w,i[10]=v*S+y*C+x*w,i[11]=g*S+R*C+_*w,i}},{key:"lookAt",value:function(t,r,n,l){var i=t[0],o=t[1],a=t[2],u=r[0],s=r[1],c=r[2],h=n[0],f=n[1],d=n[2];if(i==u&&o==s&&a==c)return e.identity(l);var E=l;null==l&&(E=e.create());var v=void 0,g=void 0,T=void 0,p=void 0,y=void 0,R=void 0,m=void 0,b=void 0,x=void 0,_=void 0;return m=i-r[0],b=o-r[1],x=a-r[2],_=1/Math.sqrt(m*m+b*b+x*x),m*=_,b*=_,x*=_,v=f*x-d*b,g=d*m-h*x,T=h*b-f*m,_=Math.sqrt(v*v+g*g+T*T),_?(_=1/_,v*=_,g*=_,T*=_):(v=0,g=0,T=0),p=b*T-x*g,y=x*v-m*T,R=m*g-b*v,_=Math.sqrt(p*p+y*y+R*R),_?(_=1/_,p*=_,y*=_,R*=_):(p=0,y=0,R=0),E[0]=v,E[1]=p,E[2]=m,E[3]=0,E[4]=g,E[5]=y,E[6]=b,E[7]=0,E[8]=T,E[9]=R,E[10]=x,E[11]=0,E[12]=-(v*i+g*o+T*a),E[13]=-(p*i+y*o+R*a),E[14]=-(m*i+b*o+x*a),E[15]=1,E}},{key:"perspective",value:function(t,r,n,l,i){var o=i;null==i&&(o=e.create());var a=n*Math.tan(t*Math.PI/360),u=a*r,s=2*u,c=2*a,h=l-n;return o[0]=2*n/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/c,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-(l+n)/h,o[11]=-1,o[12]=0,o[13]=0,o[14]=-l*n*2/h,o[15]=0,o}},{key:"ortho",value:function(t,r,n,l,i,o,a){var u=a;null==a&&(u=e.create());var s=r-t,c=n-l,h=o-i;return u[0]=2/s,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2/c,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=-2/h,u[11]=0,u[12]=-(t+r)/s,u[13]=-(n+l)/c,u[14]=-(o+i)/h,u[15]=1,u}},{key:"transpose",value:function(t,r){var n=r;return null==r&&(n=e.create()),n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15],n}},{key:"inverse",value:function(t,r){var n=r;null==r&&(n=e.create());var l=t[0],i=t[1],o=t[2],a=t[3],u=t[4],s=t[5],c=t[6],h=t[7],f=t[8],d=t[9],E=t[10],v=t[11],g=t[12],T=t[13],p=t[14],y=t[15],R=l*s-i*u,m=l*c-o*u,b=l*h-a*u,x=i*c-o*s,_=i*h-a*s,A=o*h-a*c,M=f*T-d*g,U=f*p-E*g,F=f*y-v*g,k=d*p-E*T,P=d*y-v*T,S=E*y-v*p,C=1/(R*S-m*P+b*k+x*F-_*U+A*M);return n[0]=(s*S-c*P+h*k)*C,n[1]=(-i*S+o*P-a*k)*C,n[2]=(T*A-p*_+y*x)*C,n[3]=(-d*A+E*_-v*x)*C,n[4]=(-u*S+c*F-h*U)*C,n[5]=(l*S-o*F+a*U)*C,n[6]=(-g*A+p*b-y*m)*C,n[7]=(f*A-E*b+v*m)*C,n[8]=(u*P-s*F+h*M)*C,n[9]=(-l*P+i*F-a*M)*C,n[10]=(g*_-T*b+y*R)*C,n[11]=(-f*_+d*b-v*R)*C,n[12]=(-u*k+s*U-c*M)*C,n[13]=(l*k-i*U+o*M)*C,n[14]=(-g*x+T*m-p*R)*C,n[15]=(f*x-d*m+E*R)*C,n}},{key:"toVecIV",value:function(e,t){var r=e[0],n=e[1],l=e[2],i=e[3],o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],h=e[9],f=e[10],d=e[11],E=e[12],v=e[13],g=e[14],T=e[15],p=t[0],y=t[1],R=t[2],m=t[3],b=[];return b[0]=p*r+y*o+R*c+m*E,b[1]=p*n+y*a+R*h+m*v,b[2]=p*l+y*u+R*f+m*g,b[3]=p*i+y*s+R*d+m*T,t=b,b}},{key:"vpFromCameraProperty",value:function(t,r,n,l,i,o,a,u,s,c){e.lookAt(t,r,n,u),e.perspective(l,i,o,a,s),e.multiply(s,u,c)}},{key:"screenPositionFromMvp",value:function(t,r,n,l){var i=.5*n,o=.5*l,a=e.toVecIV(t,[r[0],r[1],r[2],1]);return a[3]<=0?[NaN,NaN]:(a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],[i+a[0]*i,o-a[1]*o])}}]),e}(),a=function(){function e(){n(this,e)}return l(e,null,[{key:"create",value:function(){return new Float32Array(3)}},{key:"len",value:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"distance",value:function(t,r){var n=e.create();return n[0]=r[0]-t[0],n[1]=r[1]-t[1],n[2]=r[2]-t[2],n}},{key:"normalize",value:function(t){var r=e.create(),n=e.len(t);if(n>0){var l=1/n;r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l}else r[0]=0,r[1]=0,r[2]=0;return r}},{key:"dot",value:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{key:"cross",value:function(t,r){var n=e.create();return n[0]=t[1]*r[2]-t[2]*r[1],n[1]=t[2]*r[0]-t[0]*r[2],n[2]=t[0]*r[1]-t[1]*r[0],n}},{key:"faceNormal",value:function(t,r,n){var l=e.create(),i=[r[0]-t[0],r[1]-t[1],r[2]-t[2]],o=[n[0]-t[0],n[1]-t[1],n[2]-t[2]];return l[0]=i[1]*o[2]-i[2]*o[1],l[1]=i[2]*o[0]-i[0]*o[2],l[2]=i[0]*o[1]-i[1]*o[0],e.normalize(l)}}]),e}(),u=function(){function e(){n(this,e)}return l(e,null,[{key:"create",value:function(){return new Float32Array(2)}},{key:"len",value:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}},{key:"distance",value:function(t,r){var n=e.create();return n[0]=r[0]-t[0],n[1]=r[1]-t[1],n}},{key:"normalize",value:function(t){var r=e.create(),n=e.len(t);if(n>0){var l=1/n;r[0]=t[0]*l,r[1]=t[1]*l}return r}},{key:"dot",value:function(e,t){return e[0]*t[0]+e[1]*t[1]}},{key:"cross",value:function(t,r){e.create();return t[0]*r[1]-t[1]*r[0]}}]),e}(),s=function(){function e(){n(this,e)}return l(e,null,[{key:"create",value:function(){return new Float32Array(4)}},{key:"identity",value:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{key:"inverse",value:function(t,r){var n=r;return null==r&&(n=e.create()),n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n}},{key:"normalize",value:function(e){var t=e[0],r=e[1],n=e[2],l=Math.sqrt(t*t+r*r+n*n);return 0===l?(e[0]=0,e[1]=0,e[2]=0):(l=1/l,e[0]=t*l,e[1]=r*l,e[2]=n*l),e}},{key:"multiply",value:function(t,r,n){var l=n;null==n&&(l=e.create());var i=t[0],o=t[1],a=t[2],u=t[3],s=r[0],c=r[1],h=r[2],f=r[3];return l[0]=i*f+u*s+o*h-a*c,l[1]=o*f+u*c+a*s-i*h,l[2]=a*f+u*h+i*c-o*s,l[3]=u*f-i*s-o*c-a*h,l}},{key:"rotate",value:function(t,r,n){var l=n;null==n&&(l=e.create());var i=r[0],o=r[1],a=r[2],u=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(0!==u){var s=1/u;i*=s,o*=s,a*=s}var c=Math.sin(.5*t);return l[0]=i*c,l[1]=o*c,l[2]=a*c,l[3]=Math.cos(.5*t),l}},{key:"toVecIII",value:function(t,r,n){var l=n;null==n&&(l=[0,0,0]);var i=e.create(),o=e.create(),a=e.create();return e.inverse(r,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],e.multiply(a,i,o),e.multiply(o,r,a),l[0]=a[0],l[1]=a[1],l[2]=a[2],l}},{key:"toMatIV",value:function(e,t){var r=t;null==t&&(r=o.create());var n=e[0],l=e[1],i=e[2],a=e[3],u=n+n,s=l+l,c=i+i,h=n*u,f=n*s,d=n*c,E=l*s,v=l*c,g=i*c,T=a*u,p=a*s,y=a*c;return r[0]=1-(E+g),r[1]=f-y,r[2]=d+p,r[3]=0,r[4]=f+y,r[5]=1-(h+g),r[6]=v-T,r[7]=0,r[8]=d-p,r[9]=v+T,r[10]=1-(h+E),r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{key:"slerp",value:function(t,r,n,l){var i=l;null==l&&(i=e.create());var o=t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3],a=1-o*o;if(a<=0)i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3];else if(a=Math.sqrt(a),Math.abs(a)<1e-4)i[0]=.5*t[0]+.5*r[0],i[1]=.5*t[1]+.5*r[1],i[2]=.5*t[2]+.5*r[2],i[3]=.5*t[3]+.5*r[3];else{var u=Math.acos(o),s=u*n,c=Math.sin(u-s)/a,h=Math.sin(s)/a;i[0]=t[0]*c+r[0]*h,i[1]=t[1]*c+r[1]*h,i[2]=t[2]*c+r[2]*h,i[3]=t[3]*c+r[3]*h}return i}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return l(e,null,[{key:"plane",value:function(e,t,r){var n=void 0,l=void 0;return n=e/2,l=t/2,tc=r||[1,1,1,1],{position:[-n,l,0,n,l,0,-n,-l,0,n,-l,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],color:[r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3]],texCoord:[0,0,1,0,0,1,1,1],index:[0,1,2,2,1,3]}}},{key:"circle",value:function(e,t,r){var n=void 0,l=0,i=[],o=[],a=[],u=[],s=[];for(i.push(0,0,0),o.push(0,0,1),a.push(r[0],r[1],r[2],r[3]),u.push(.5,.5),n=0;n<e;n++){var c=2*Math.PI/e*n,h=Math.cos(c),f=Math.sin(c);i.push(h*t,f*t,0),o.push(0,0,1),a.push(r[0],r[1],r[2],r[3]),u.push(.5*(h+1),1-.5*(f+1)),n===e-1?s.push(0,l+1,1):s.push(0,l+1,l+2),++l}return{position:i,normal:o,color:a,texCoord:u,index:s}}},{key:"cube",value:function(e,t){for(var r=.5*e,n=[-r,-r,r,r,-r,r,r,r,r,-r,r,r,-r,-r,-r,-r,r,-r,r,r,-r,r,-r,-r,-r,r,-r,-r,r,r,r,r,r,r,r,-r,-r,-r,-r,r,-r,-r,r,-r,r,-r,-r,r,r,-r,-r,r,r,-r,r,r,r,r,-r,r,-r,-r,-r,-r,-r,r,-r,r,r,-r,r,-r],l=1/Math.sqrt(3),i=[-l,-l,l,l,-l,l,l,l,l,-l,l,l,-l,-l,-l,-l,l,-l,l,l,-l,l,-l,-l,-l,l,-l,-l,l,l,l,l,l,l,l,-l,-l,-l,-l,l,-l,-l,l,-l,l,-l,-l,l,l,-l,-l,l,l,-l,l,l,l,l,-l,l,-l,-l,-l,-l,-l,l,-l,l,l,-l,l,-l],o=[],a=0;a<n.length/3;a++)o.push(t[0],t[1],t[2],t[3]);return{position:n,normal:i,color:o,texCoord:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],index:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}}},{key:"cone",value:function(e,t,r,n){var l=void 0,i=0,o=r/2,a=[],u=[],s=[],c=[],h=[];for(a.push(0,-o,0),u.push(0,-1,0),s.push(n[0],n[1],n[2],n[3]),c.push(.5,.5),l=0;l<=e;l++){var f=2*Math.PI/e*l,d=Math.cos(f),E=Math.sin(f);a.push(d*t,-o,E*t,d*t,-o,E*t),u.push(0,-1,0,d,0,E),s.push(n[0],n[1],n[2],n[3],n[0],n[1],n[2],n[3]),c.push(.5*(d+1),1-.5*(E+1),.5*(d+1),1-.5*(E+1)),l!==e&&(h.push(0,i+1,i+3),h.push(i+4,i+2,2*e+3)),i+=2}return a.push(0,o,0),u.push(0,1,0),s.push(n[0],n[1],n[2],n[3]),c.push(.5,.5),{position:a,normal:u,color:s,texCoord:c,index:h}}},{key:"cylinder",value:function(e,t,r,n,l){var i=void 0,o=2,a=n/2,u=[],s=[],c=[],h=[],f=[];for(u.push(0,a,0,0,-a,0),s.push(0,1,0,0,-1,0),c.push(l[0],l[1],l[2],l[3],l[0],l[1],l[2],l[3]),h.push(.5,.5,.5,.5),i=0;i<=e;i++){var d=2*Math.PI/e*i,E=Math.cos(d),v=Math.sin(d);u.push(E*t,a,v*t,E*t,a,v*t,E*r,-a,v*r,E*r,-a,v*r),s.push(0,1,0,E,0,v,0,-1,0,E,0,v),c.push(l[0],l[1],l[2],l[3],l[0],l[1],l[2],l[3],l[0],l[1],l[2],l[3],l[0],l[1],l[2],l[3]),h.push(.5*(E+1),1-.5*(v+1),1-i/e,0,.5*(E+1),1-.5*(v+1),1-i/e,1),i!==e&&f.push(0,o+4,o,1,o+2,o+6,o+5,o+7,o+1,o+1,o+7,o+3),o+=4}return{position:u,normal:s,color:c,texCoord:h,index:f}}},{key:"sphere",value:function(e,t,r,n){var l=void 0,i=void 0,o=[],a=[],u=[],s=[],c=[];for(l=0;l<=e;l++){var h=Math.PI/e*l,f=Math.cos(h),d=Math.sin(h);for(i=0;i<=t;i++){var E=2*Math.PI/t*i,v=d*r*Math.cos(E),g=f*r,T=d*r*Math.sin(E),p=d*Math.cos(E),y=d*Math.sin(E);o.push(v,g,T),a.push(p,f,y),u.push(n[0],n[1],n[2],n[3]),s.push(1-1/t*i,1/e*l)}}for(l=0;l<e;l++)for(i=0;i<t;i++){var R=(t+1)*l+i;c.push(R,R+1,R+t+2),c.push(R,R+t+2,R+t+1)}return{position:o,normal:a,color:u,texCoord:s,index:c}}},{key:"torus",value:function(e,t,r,n,l){var i=void 0,o=void 0,a=[],u=[],s=[],c=[],h=[];for(i=0;i<=e;i++){var f=2*Math.PI/e*i,d=Math.cos(f),E=Math.sin(f);for(o=0;o<=t;o++){var v=2*Math.PI/t*o,g=(d*r+n)*Math.cos(v),T=E*r,p=(d*r+n)*Math.sin(v),y=d*Math.cos(v),R=d*Math.sin(v),m=1/t*o,b=1/e*i+.5;b>1&&(b-=1),b=1-b,a.push(g,T,p),u.push(y,E,R),s.push(l[0],l[1],l[2],l[3]),c.push(m,b)}}for(i=0;i<e;i++)for(o=0;o<t;o++){var x=(t+1)*i+o;h.push(x,x+t+1,x+1),h.push(x+t+1,x+t+2,x+1)}return{position:a,normal:u,color:s,texCoord:c,index:h}}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e)}return l(e,null,[{key:"hsva",value:function(e,t,r,n){if(!(t>1||r>1||n>1)){var l=e%360,i=Math.floor(l/60),o=l/60-i,a=r*(1-t),u=r*(1-t*o),s=r*(1-t*(1-o)),c=new Array;if(!t>0&&!t<0)c.push(r,r,r,n);else{var h=new Array(r,u,a,a,s,r),f=new Array(s,r,r,u,a,a),d=new Array(a,a,s,r,r,u);c.push(h[i],f[i],d[i],n)}return c}}},{key:"easeLiner",value:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}},{key:"easeOutCubic",value:function(e){return(e=e/1-1)*e*e+1}},{key:"easeQuintic",value:function(e){var t=(e/=1)*e;return t*e*t}},{key:"degToRad",value:function(e){return e%360*Math.PI/180}},{key:"lonToMer",value:function(t){return e.EARTH_RADIUS*e.degToRad(t)}},{key:"latToMer",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r;isNaN(parseFloat(r))&&(n=0);t>=89.9999&&(t=89.9999),t<=1e-4-90&&(t=1e-4-90);var l=1-n,i=1-l*l,o=Math.sqrt(i),a=e.degToRad(t),u=Math.sin(a),s=o*u,c=.5*o;s=Math.pow((1-s)/(1+s),c);var h=Math.tan(.5*(.5*Math.PI-a))/s;return e.EARTH_RADIUS*Math.log(h)}},{key:"lonLatToMer",value:function(t,r){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{x:e.lonToMer(t),y:e.latToMer(r,flattening)}}},{key:"merToLonLat",value:function(t,r){var n=t/e.EARTH_HALF_CIRCUM*180,l=r/e.EARTH_HALF_CIRCUM*180;return l=180/Math.PI*(2*Math.atan(Math.exp(l*Math.PI/180))-Math.PI/2),{lon:n,lat:l}}},{key:"lonToTile",value:function(e,t){return Math.floor((e/180+1)*Math.pow(2,t)/2)}},{key:"latToTile",value:function(e,t){return Math.floor((-Math.log(Math.tan((45+e/2)*Math.PI/180))+Math.PI)*Math.pow(2,t)/(2*Math.PI))}},{key:"lonLatToTile",value:function(t,r,n){return{lon:e.lonToTile(t,n),lat:e.latToTile(r,n)}}},{key:"tileToLon",value:function(e,t){return e/Math.pow(2,t)*360-180}},{key:"tileToLat",value:function(e,t){var r=e/Math.pow(2,t)*2*Math.PI-Math.PI;return 2*Math.atan(Math.pow(Math.E,-r))*180/Math.PI-90}},{key:"tileToLonLat",value:function(t,r,n){return{lon:e.tileToLon(t,n),lat:e.tileToLat(r,n)}}},{key:"EARTH_RADIUS",get:function(){return 6378.137}},{key:"EARTH_CIRCUM",get:function(){return e.EARTH_RADIUS*Math.PI*2}},{key:"EARTH_HALF_CIRCUM",get:function(){return e.EARTH_RADIUS*Math.PI}},{key:"EARTH_MAX_LAT",get:function(){return 85.05112878}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=n(o),u=r(2),s=n(u),c=r(3),h=n(c),f=r(4),d=n(f),E=r(1),v=n(E),g=function(){function e(){l(this,e),this.VERSION="0.1.8",this.PI2=6.283185307179586,this.PI=3.141592653589793,this.PIH=1.5707963267948966,this.PIH2=.7853981633974483,this.TEXTURE_UNIT_COUNT=null,this.ready=!1,this.canvas=null,this.gl=null,this.isWebGL2=!1,this.textures=null,this.ext=null,this.Audio=a.default,this.Mesh=h.default,this.Util=d.default,this.Gui=new v.default,this.Math=new s.default,console.log("%c◆%c glcubic.js %c◆%c : version %c"+this.VERSION,"color: crimson","","color: crimson","","color: royalblue")}return i(e,[{key:"init",value:function(e,t,r){var n=t||{};return this.ready=!1,null!=e&&(e instanceof HTMLCanvasElement?this.canvas=e:"[object String]"===Object.prototype.toString.call(e)&&(this.canvas=document.getElementById(e)),null!=this.canvas&&(!0===r&&(this.gl=this.canvas.getContext("webgl2",n),this.isWebGL2=!0),null==this.gl&&(this.gl=this.canvas.getContext("webgl",n)||this.canvas.getContext("experimental-webgl",n)),null!=this.gl&&(this.ready=!0,this.TEXTURE_UNIT_COUNT=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.textures=new Array(this.TEXTURE_UNIT_COUNT)),this.ext={elementIndexUint:this.gl.getExtension("OES_element_index_uint"),textureFloat:this.gl.getExtension("OES_texture_float"),textureHalfFloat:this.gl.getExtension("OES_texture_half_float"),drawBuffers:this.gl.getExtension("WEBGL_draw_buffers")},this.ready))}},{key:"sceneClear",value:function(e,t,r){var n=this.gl,l=n.COLOR_BUFFER_BIT;n.clearColor(e[0],e[1],e[2],e[3]),null!=t&&(n.clearDepth(t),l|=n.DEPTH_BUFFER_BIT),null!=r&&(n.clearStencil(r),l|=n.STENCIL_BUFFER_BIT),n.clear(l)}},{key:"sceneView",value:function(e,t,r,n){var l=e||0,i=t||0,o=r||window.innerWidth,a=n||window.innerHeight;this.gl.viewport(l,i,o,a)}},{key:"drawArrays",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawArrays(e,r,t)}},{key:"drawElements",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawElements(e,t,this.gl.UNSIGNED_SHORT,r)}},{key:"drawElementsInt",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawElements(e,t,this.gl.UNSIGNED_INT,r)}},{key:"createVbo",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),t}}},{key:"createIbo",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Int16Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),t}}},{key:"createIboInt",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),t}}},{key:"createTextureFromFile",value:function(e,t,r){var n=this;if(null!=e&&null!=t){var l=new Image,i=this.gl;l.onload=function(){n.textures[t]={texture:null,type:null,loaded:!1};var o=i.createTexture();i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,l),i.generateMipmap(i.TEXTURE_2D),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n.textures[t].texture=o,n.textures[t].type=i.TEXTURE_2D,n.textures[t].loaded=!0,console.log("%c◆%c texture number: %c"+t+"%c, file loaded: %c"+e,"color: crimson","","color: blue","","color: goldenrod"),i.bindTexture(i.TEXTURE_2D,null),null!=r&&r(t)},l.src=e}}},{key:"createTextureFromObject",value:function(e,t){if(null!=e&&null!=t){var r=this.gl,n=r.createTexture();this.textures[t]={texture:null,type:null,loaded:!1},r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),this.textures[t].texture=n,this.textures[t].type=r.TEXTURE_2D,this.textures[t].loaded=!0,console.log("%c◆%c texture number: %c"+t+"%c, object attached","color: crimson","","color: blue",""),r.bindTexture(r.TEXTURE_2D,null)}}},{key:"createTextureCubeFromFile",value:function(e,t,r,n){var l=this;if(null!=e&&null!=t&&null!=r){var i=[],o=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};for(var a=0;a<e.length;a++)i[a]={image:new Image,loaded:!1},i[a].image.onload=function(a){return function(){if(i[a].loaded=!0,6===i.length){var u=!0;if(i.map(function(e){u=u&&e.loaded}),!0===u){var s=o.createTexture();o.activeTexture(o.TEXTURE0+r),o.bindTexture(o.TEXTURE_CUBE_MAP,s);for(var c=0;c<e.length;c++)o.texImage2D(t[c],0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,i[c].image);o.generateMipmap(o.TEXTURE_CUBE_MAP),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),l.textures[r].texture=s,l.textures[r].type=o.TEXTURE_CUBE_MAP,l.textures[r].loaded=!0,console.log("%c◆%c texture number: %c"+r+"%c, file loaded: %c"+e[0]+"...","color: crimson","","color: blue","","color: goldenrod"),o.bindTexture(o.TEXTURE_CUBE_MAP,null),null!=n&&n(r)}}}}(a),i[a].image.src=e[a]}}},{key:"bindTexture",value:function(e,t){null!=this.textures[t]&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.textures[t].type,this.textures[t].texture))}},{key:"isTextureLoaded",value:function(){var e=void 0,t=void 0,r=void 0,n=void 0;for(r=!0,n=!1,e=0,t=this.textures.length;e<t;e++)null!=this.textures[e]&&(n=!0,r=r&&this.textures[e].loaded);return!!n&&r}},{key:"createFramebuffer",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){var n=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l);var i=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,i),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,i);var o=n.createTexture();return n.activeTexture(n.TEXTURE0+r),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=o,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%c◆%c texture number: %c"+r+"%c, framebuffer created","color: crimson","","color: blue",""),{framebuffer:l,depthRenderbuffer:i,texture:o}}}},{key:"createFramebufferStencil",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){var n=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l);var i=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,i),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i);var o=n.createTexture();return n.activeTexture(n.TEXTURE0+r),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=o,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%c◆%c texture number: %c"+r+"%c, framebuffer created (enable stencil)","color: crimson","","color: blue",""),{framebuffer:l,depthStencilRenderbuffer:i,texture:o}}}},{key:"createFramebufferFloat",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){if(null==this.ext||null==this.ext.textureFloat&&null==this.ext.textureHalfFloat)return void console.log("float texture not support");var n=this.gl,l=null!=this.ext.textureFloat?n.FLOAT:this.ext.textureHalfFloat.HALF_FLOAT_OES;this.textures[r]={texture:null,type:null,loaded:!1};var i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i);var o=n.createTexture();return n.activeTexture(n.TEXTURE0+r),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,l,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,o,0),n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=o,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%c◆%c texture number: %c"+r+"%c, framebuffer created (enable float)","color: crimson","","color: blue",""),{framebuffer:i,depthRenderbuffer:null,texture:o}}}},{key:"createFramebufferCube",value:function(e,t,r,n){if(null!=e&&null!=t&&null!=r&&null!=n){var l=this.gl;this.textures[n]={texture:null,type:null,loaded:!1};var i=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,i);var o=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,o),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,e,t),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,o);var a=l.createTexture();l.activeTexture(l.TEXTURE0+n),l.bindTexture(l.TEXTURE_CUBE_MAP,a);for(var u=0;u<r.length;u++)l.texImage2D(r[u],0,l.RGBA,e,t,0,l.RGBA,l.UNSIGNED_BYTE,null);return l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.bindTexture(l.TEXTURE_CUBE_MAP,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),this.textures[n].texture=a,this.textures[n].type=l.TEXTURE_CUBE_MAP,this.textures[n].loaded=!0,console.log("%c◆%c texture number: %c"+n+"%c, framebuffer cube created","color: crimson","","color: blue",""),{framebuffer:i,depthRenderbuffer:o,texture:a}}}},{key:"createProgramFromId",value:function(e,t,r,n,l,i){if(null==this.gl)return null;var o=void 0,a=new T(this.gl);if(a.vs=a.createShaderFromId(e),a.fs=a.createShaderFromId(t),a.prg=a.createProgram(a.vs,a.fs),null==a.prg)return a;for(a.attL=new Array(r.length),a.attS=new Array(r.length),o=0;o<r.length;o++)a.attL[o]=this.gl.getAttribLocation(a.prg,r[o]),a.attS[o]=n[o];for(a.uniL=new Array(l.length),o=0;o<l.length;o++)a.uniL[o]=this.gl.getUniformLocation(a.prg,l[o]);return a.uniT=i,a.locationCheck(r,l),a}},{key:"createProgramFromSource",value:function(e,t,r,n,l,i){if(null==this.gl)return null;var o=void 0,a=new T(this.gl);if(a.vs=a.createShaderFromSource(e,this.gl.VERTEX_SHADER),a.fs=a.createShaderFromSource(t,this.gl.FRAGMENT_SHADER),a.prg=a.createProgram(a.vs,a.fs),null==a.prg)return a;for(a.attL=new Array(r.length),a.attS=new Array(r.length),o=0;o<r.length;o++)a.attL[o]=this.gl.getAttribLocation(a.prg,r[o]),a.attS[o]=n[o];for(a.uniL=new Array(l.length),o=0;o<l.length;o++)a.uniL[o]=this.gl.getUniformLocation(a.prg,l[o]);return a.uniT=i,a.locationCheck(r,l),a}},{key:"createProgramFromFile",value:function(e,t,r,n,l,i,o){function a(e,t){var r=new XMLHttpRequest;r.open("GET",t.targetUrl,!0),r.setRequestHeader("Pragma","no-cache"),r.setRequestHeader("Cache-Control","no-cache"),r.onload=function(){console.log("%c◆%c shader file loaded: %c"+t.targetUrl,"color: crimson","","color: goldenrod"),t.source=r.responseText,u(e)},r.send()}function u(e){if(null!=c.vs.source&&null!=c.fs.source){var t=void 0;if(s.vs=s.createShaderFromSource(c.vs.source,e.VERTEX_SHADER),s.fs=s.createShaderFromSource(c.fs.source,e.FRAGMENT_SHADER),s.prg=s.createProgram(s.vs,s.fs),null==s.prg)return s;for(s.attL=new Array(r.length),s.attS=new Array(r.length),t=0;t<r.length;t++)s.attL[t]=e.getAttribLocation(s.prg,r[t]),s.attS[t]=n[t];for(s.uniL=new Array(l.length),t=0;t<l.length;t++)s.uniL[t]=e.getUniformLocation(s.prg,l[t]);s.uniT=i,s.locationCheck(r,l),o(s)}}if(null==this.gl)return null;var s=new T(this.gl),c={vs:{targetUrl:e,source:null},fs:{targetUrl:t,source:null}};return a(this.gl,c.vs),a(this.gl,c.fs),s}},{key:"deleteBuffer",value:function(e){!0===this.gl.isBuffer(e)&&(this.gl.deleteBuffer(e),e=null)}},{key:"deleteTexture",value:function(e){!0===this.gl.isTexture(e)&&(this.gl.deleteTexture(e),e=null)}},{key:"deleteFramebuffer",value:function(e){if(null!=e){for(var t in e)e[t]instanceof WebGLFramebuffer&&!0===this.gl.isFramebuffer(e[t])?(this.gl.deleteFramebuffer(e[t]),e[t]=null):e[t]instanceof WebGLRenderbuffer&&!0===this.gl.isRenderbuffer(e[t])?(this.gl.deleteRenderbuffer(e[t]),e[t]=null):e[t]instanceof WebGLTexture&&!0===this.gl.isTexture(e[t])&&(this.gl.deleteTexture(e[t]),e[t]=null);e=null}}},{key:"deleteShader",value:function(e){!0===this.gl.isShader(e)&&(this.gl.deleteShader(e),e=null)}},{key:"deleteProgram",value:function(e){!0===this.gl.isProgram(e)&&(this.gl.deleteProgram(e),e=null)}},{key:"deleteProgramManager",value:function(e){null!=e&&e instanceof T&&(this.deleteShader(e.vs),this.deleteShader(e.fs),this.deleteProgram(e.prg),e.attL=null,e.attS=null,e.uniL=null,e.uniT=null,e=null)}}]),e}();t.default=g;var T=function(){function e(t){l(this,e),this.gl=t,this.vs=null,this.fs=null,this.prg=null,this.attL=null,this.attS=null,this.uniL=null,this.uniT=null,this.error={vs:null,fs:null,prg:null}}return i(e,[{key:"createShaderFromId",value:function(e){var t=void 0,r=document.getElementById(e);if(r){switch(r.type){case"x-shader/x-vertex":t=this.gl.createShader(this.gl.VERTEX_SHADER);break;case"x-shader/x-fragment":t=this.gl.createShader(this.gl.FRAGMENT_SHADER);break;default:return}var n=r.text;if(!0!==this.isWebGL2&&n.search(/^#version 300 es/)>-1)return void console.warn("◆ can not use glsl es 3.0");if(this.gl.shaderSource(t,n),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS))return t;var l=this.gl.getShaderInfoLog(t);"x-shader/x-vertex"===r.type?this.error.vs=l:this.error.fs=l,console.warn("◆ compile failed of shader: "+l)}}},{key:"createShaderFromSource",value:function(e,t){var r=void 0;switch(t){case this.gl.VERTEX_SHADER:r=this.gl.createShader(this.gl.VERTEX_SHADER);break;case this.gl.FRAGMENT_SHADER:r=this.gl.createShader(this.gl.FRAGMENT_SHADER);break;default:return}if(!0!==this.isWebGL2&&e.search(/^#version 300 es/)>-1)return void console.warn("◆ can not use glsl es 3.0");if(this.gl.shaderSource(r,e),this.gl.compileShader(r),this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS))return r;var n=this.gl.getShaderInfoLog(r);t===this.gl.VERTEX_SHADER?this.error.vs=n:this.error.fs=n,console.warn("◆ compile failed of shader: "+n)}},{key:"createProgram",value:function(e,t){if(null==e||null==t)return null;var r=this.gl.createProgram();if(this.gl.attachShader(r,e),this.gl.attachShader(r,t),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS))return this.gl.useProgram(r),r;var n=this.gl.getProgramInfoLog(r);this.error.prg=n,console.warn("◆ link program failed: "+n)}},{key:"useProgram",value:function(){this.gl.useProgram(this.prg)}},{key:"setAttribute",value:function(e,t){var r=this.gl;for(var n in e)this.attL[n]>=0&&(r.bindBuffer(r.ARRAY_BUFFER,e[n]),r.enableVertexAttribArray(this.attL[n]),r.vertexAttribPointer(this.attL[n],this.attS[n],r.FLOAT,!1,0,0));null!=t&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t)}},{key:"pushShader",value:function(e){for(var t=this.gl,r=0,n=this.uniT.length;r<n;r++){var l="uniform"+this.uniT[r].replace(/matrix/i,"Matrix");null!=t[l]?-1!==l.search(/Matrix/)?t[l](this.uniL[r],!1,e[r]):t[l](this.uniL[r],e[r]):console.warn("◆ not support uniform type: "+this.uniT[r])}}},{key:"locationCheck",value:function(e,t){var r=void 0,n=void 0;for(r=0,n=e.length;r<n;r++)(null==this.attL[r]||this.attL[r]<0)&&console.warn('◆ invalid attribute location: %c"'+e[r]+'"',"color: crimson");for(r=0,n=t.length;r<n;r++)(null==this.uniL[r]||this.uniL[r]<0)&&console.warn('◆ invalid uniform location: %c"'+t[r]+'"',"color: crimson")}}]),e}();window.gl3=window.gl3||new g}]);