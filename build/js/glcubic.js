!function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=4)}([function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(){function e(t,r){if(n(this,e),"undefined"==typeof AudioContext&&"undefined"==typeof webkitAudioContext)return null;"undefined"!=typeof AudioContext?this.ctx=new AudioContext:this.ctx=new webkitAudioContext,this.comp=this.ctx.createDynamicsCompressor(),this.comp.connect(this.ctx.destination),this.bgmGain=this.ctx.createGain(),this.bgmGain.connect(this.comp),this.bgmGain.gain.value=t,this.soundGain=this.ctx.createGain(),this.soundGain.connect(this.comp),this.soundGain.gain.value=r,this.src=[]}return a(e,[{key:"load",value:function(e,t,r,n,a){var u=this.ctx,o=n?this.bgmGain:this.soundGain,l=this.src;l[t]=null;var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Pragma","no-cache"),s.setRequestHeader("Cache-Control","no-cache"),s.responseType="arraybuffer",s.onload=function(){u.decodeAudioData(s.response,function(s){l[t]=new i(u,o,s,r,n),l[t].loaded=!0,console.log("%câ—†%c audio number: %c"+t+"%c, audio loaded: %c"+e,"color: crimson","","color: blue","","color: goldenrod"),a()},function(e){console.log(e)})},s.send()}},{key:"loadComplete",value:function(){var e=void 0,t=void 0;for(t=!0,e=0;e<this.src.length;e++)t=t&&null!=this.src[e]&&this.src[e].loaded;return t}}]),e}();t.default=u;var i=function(){function e(t,r,a,u,i){n(this,e),this.ctx=t,this.gain=r,this.audioBuffer=a,this.bufferSource=[],this.activeBufferSource=0,this.loop=u,this.loaded=!1,this.fftLoop=16,this.update=!1,this.background=i,this.node=this.ctx.createScriptProcessor(2048,1,1),this.analyser=this.ctx.createAnalyser(),this.analyser.smoothingTimeConstant=.8,this.analyser.fftSize=2*this.fftLoop,this.onData=new Uint8Array(this.analyser.frequencyBinCount)}return a(e,[{key:"play",value:function(){function e(e){u.update&&(u.update=!1,u.analyser.getByteFrequencyData(u.onData))}var t=this,r=void 0,n=void 0,a=void 0,u=this;if(r=this.bufferSource.length,a=-1,r>0){for(n=0;n<r;n++)if(!this.bufferSource[n].playnow){this.bufferSource[n]=null,this.bufferSource[n]=this.ctx.createBufferSource(),a=n;break}a<0&&(this.bufferSource[this.bufferSource.length]=this.ctx.createBufferSource(),a=this.bufferSource.length-1)}else this.bufferSource[0]=this.ctx.createBufferSource(),a=0;this.activeBufferSource=a,this.bufferSource[a].buffer=this.audioBuffer,this.bufferSource[a].loop=this.loop,this.bufferSource[a].playbackRate.value=1,this.loop||(this.bufferSource[a].onended=function(){t.stop(0),t.playnow=!1}),this.background&&(this.bufferSource[a].connect(this.analyser),this.analyser.connect(this.node),this.node.connect(this.ctx.destination),this.node.onaudioprocess=function(t){e(t)}),this.bufferSource[a].connect(this.gain),this.bufferSource[a].start(0),this.bufferSource[a].playnow=!0}},{key:"stop",value:function(){this.bufferSource[this.activeBufferSource].stop(0),this.playnow=!1}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(){n(this,e),this.Mat4=i,this.Vec3=o,this.Vec2=l,this.Qtn=s};t.default=u;var i=function(){function e(){n(this,e)}return a(e,null,[{key:"create",value:function(){return new Float32Array(16)}},{key:"identity",value:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"multiply",value:function(e,t,r){var n=e[0],a=e[1],u=e[2],i=e[3],o=e[4],l=e[5],s=e[6],c=e[7],f=e[8],E=e[9],h=e[10],T=e[11],d=e[12],R=e[13],v=e[14],g=e[15],_=t[0],b=t[1],m=t[2],A=t[3],y=t[4],x=t[5],U=t[6],p=t[7],F=t[8],M=t[9],P=t[10],D=t[11],S=t[12],B=t[13],I=t[14],X=t[15];return r[0]=_*n+b*o+m*f+A*d,r[1]=_*a+b*l+m*E+A*R,r[2]=_*u+b*s+m*h+A*v,r[3]=_*i+b*c+m*T+A*g,r[4]=y*n+x*o+U*f+p*d,r[5]=y*a+x*l+U*E+p*R,r[6]=y*u+x*s+U*h+p*v,r[7]=y*i+x*c+U*T+p*g,r[8]=F*n+M*o+P*f+D*d,r[9]=F*a+M*l+P*E+D*R,r[10]=F*u+M*s+P*h+D*v,r[11]=F*i+M*c+P*T+D*g,r[12]=S*n+B*o+I*f+X*d,r[13]=S*a+B*l+I*E+X*R,r[14]=S*u+B*s+I*h+X*v,r[15]=S*i+B*c+I*T+X*g,r}},{key:"scale",value:function(e,t,r){return r[0]=e[0]*t[0],r[1]=e[1]*t[0],r[2]=e[2]*t[0],r[3]=e[3]*t[0],r[4]=e[4]*t[1],r[5]=e[5]*t[1],r[6]=e[6]*t[1],r[7]=e[7]*t[1],r[8]=e[8]*t[2],r[9]=e[9]*t[2],r[10]=e[10]*t[2],r[11]=e[11]*t[2],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}},{key:"translate",value:function(e,t,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12],r[13]=e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13],r[14]=e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14],r[15]=e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15],r}},{key:"rotate",value:function(e,t,r,n){var a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);if(!a)return null;var u=r[0],i=r[1],o=r[2];1!=a&&(a=1/a,u*=a,i*=a,o*=a);var l=Math.sin(t),s=Math.cos(t),c=1-s,f=e[0],E=e[1],h=e[2],T=e[3],d=e[4],R=e[5],v=e[6],g=e[7],_=e[8],b=e[9],m=e[10],A=e[11],y=u*u*c+s,x=i*u*c+o*l,U=o*u*c-i*l,p=u*i*c-o*l,F=i*i*c+s,M=o*i*c+u*l,P=u*o*c+i*l,D=i*o*c-u*l,S=o*o*c+s;return t?e!=n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=f*y+d*x+_*U,n[1]=E*y+R*x+b*U,n[2]=h*y+v*x+m*U,n[3]=T*y+g*x+A*U,n[4]=f*p+d*F+_*M,n[5]=E*p+R*F+b*M,n[6]=h*p+v*F+m*M,n[7]=T*p+g*F+A*M,n[8]=f*P+d*D+_*S,n[9]=E*P+R*D+b*S,n[10]=h*P+v*D+m*S,n[11]=T*P+g*D+A*S,n}},{key:"lookAt",value:function(t,r,n,a){var u=t[0],i=t[1],o=t[2],l=n[0],s=n[1],c=n[2],f=r[0],E=r[1],h=r[2];if(u==f&&i==E&&o==h)return e.identity(a);var T=void 0,d=void 0,R=void 0,v=void 0,g=void 0,_=void 0,b=void 0,m=void 0,A=void 0,y=void 0;return b=u-r[0],m=i-r[1],A=o-r[2],y=1/Math.sqrt(b*b+m*m+A*A),b*=y,m*=y,A*=y,T=s*A-c*m,d=c*b-l*A,R=l*m-s*b,y=Math.sqrt(T*T+d*d+R*R),y?(y=1/y,T*=y,d*=y,R*=y):(T=0,d=0,R=0),v=m*R-A*d,g=A*T-b*R,_=b*d-m*T,y=Math.sqrt(v*v+g*g+_*_),y?(y=1/y,v*=y,g*=y,_*=y):(v=0,g=0,_=0),a[0]=T,a[1]=v,a[2]=b,a[3]=0,a[4]=d,a[5]=g,a[6]=m,a[7]=0,a[8]=R,a[9]=_,a[10]=A,a[11]=0,a[12]=-(T*u+d*i+R*o),a[13]=-(v*u+g*i+_*o),a[14]=-(b*u+m*i+A*o),a[15]=1,a}},{key:"perspective",value:function(e,t,r,n,a){var u=r*Math.tan(e*Math.PI/360),i=u*t,o=2*i,l=2*u,s=n-r;return a[0]=2*r/o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*r/l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-(n+r)/s,a[11]=-1,a[12]=0,a[13]=0,a[14]=-n*r*2/s,a[15]=0,a}},{key:"ortho",value:function(e,t,r,n,a,u,i){var o=t-e,l=r-n,s=u-a;return i[0]=2/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2/s,i[11]=0,i[12]=-(e+t)/o,i[13]=-(r+n)/l,i[14]=-(u+a)/s,i[15]=1,i}},{key:"transpose",value:function(e,t){return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t}},{key:"inverse",value:function(e,t){var r=e[0],n=e[1],a=e[2],u=e[3],i=e[4],o=e[5],l=e[6],s=e[7],c=e[8],f=e[9],E=e[10],h=e[11],T=e[12],d=e[13],R=e[14],v=e[15],g=r*o-n*i,_=r*l-a*i,b=r*s-u*i,m=n*l-a*o,A=n*s-u*o,y=a*s-u*l,x=c*d-f*T,U=c*R-E*T,p=c*v-h*T,F=f*R-E*d,M=f*v-h*d,P=E*v-h*R,D=1/(g*P-_*M+b*F+m*p-A*U+y*x);return t[0]=(o*P-l*M+s*F)*D,t[1]=(-n*P+a*M-u*F)*D,t[2]=(d*y-R*A+v*m)*D,t[3]=(-f*y+E*A-h*m)*D,t[4]=(-i*P+l*p-s*U)*D,t[5]=(r*P-a*p+u*U)*D,t[6]=(-T*y+R*b-v*_)*D,t[7]=(c*y-E*b+h*_)*D,t[8]=(i*M-o*p+s*x)*D,t[9]=(-r*M+n*p-u*x)*D,t[10]=(T*A-d*b+v*g)*D,t[11]=(-c*A+f*b-h*g)*D,t[12]=(-i*F+o*U-l*x)*D,t[13]=(r*F-n*U+a*x)*D,t[14]=(-T*m+d*_-R*g)*D,t[15]=(c*m-f*_+E*g)*D,t}},{key:"toVecIV",value:function(e,t){var r=e[0],n=e[1],a=e[2],u=e[3],i=e[4],o=e[5],l=e[6],s=e[7],c=e[8],f=e[9],E=e[10],h=e[11],T=e[12],d=e[13],R=e[14],v=e[15],g=t[0],_=t[1],b=t[2],m=t[3],A=[];return A[0]=g*r+_*i+b*c+m*T,A[1]=g*n+_*o+b*f+m*d,A[2]=g*a+_*l+b*E+m*R,A[3]=g*u+_*s+b*h+m*v,A}},{key:"vpFromCameraProperty",value:function(t,r,n,a,u,i,o,l,s,c){e.lookAt(t,r,n,l),e.perspective(a,u,i,o,s),e.multiply(s,l,c)}},{key:"screenPositionFromMvp",value:function(t,r,n,a){var u=.5*n,i=.5*a,o=e.toVecIV(t,[r[0],r[1],r[2],1]);return o[3]<=0?[NaN,NaN]:(o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],[u+o[0]*u,i-o[1]*i])}}]),e}(),o=function(){function e(){n(this,e)}return a(e,null,[{key:"create",value:function(){return new Float32Array(3)}},{key:"length",value:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"distance",value:function(t,r){var n=e.create();return n[0]=r[0]-t[0],n[1]=r[1]-t[1],n[2]=r[2]-t[2],n}},{key:"normalize",value:function(t){var r=e.create(),n=e.length(t);if(n>0){var a=1/n;r[0]=t[0]*a,r[1]=t[1]*a,r[2]=t[2]*a}return r}},{key:"dot",value:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{key:"cross",value:function(t,r){var n=e.create();return n[0]=t[1]*r[2]-t[2]*r[1],n[1]=t[2]*r[0]-t[0]*r[2],n[2]=t[0]*r[1]-t[1]*r[0],n}},{key:"faceNormal",value:function(t,r,n){var a=e.create(),u=[r[0]-t[0],r[1]-t[1],r[2]-t[2]],i=[n[0]-t[0],n[1]-t[1],n[2]-t[2]];return a[0]=u[1]*i[2]-u[2]*i[1],a[1]=u[2]*i[0]-u[0]*i[2],a[2]=u[0]*i[1]-u[1]*i[0],e.normalize(a)}}]),e}(),l=function(){function e(){n(this,e)}return a(e,null,[{key:"create",value:function(){return new Float32Array(2)}},{key:"length",value:function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}},{key:"distance",value:function(t,r){var n=e.create();return n[0]=r[0]-t[0],n[1]=r[1]-t[1],n}},{key:"normalize",value:function(t){var r=e.create(),n=e.length(t);if(n>0){var a=1/n;r[0]=t[0]*a,r[1]=t[1]*a}return r}},{key:"dot",value:function(e,t){return e[0]*t[0]+e[1]*t[1]}},{key:"cross",value:function(t,r){e.create();return t[0]*r[1]-t[1]*r[0]}}]),e}(),s=function(){function e(){n(this,e)}return a(e,null,[{key:"create",value:function(){return new Float32Array(4)}},{key:"identity",value:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{key:"inverse",value:function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}},{key:"normalize",value:function(e){var t=e[0],r=e[1],n=e[2],a=e[3],u=Math.sqrt(t*t+r*r+n*n+a*a);return 0===u?(e[0]=0,e[1]=0,e[2]=0,e[3]=0):(u=1/u,e[0]=t*u,e[1]=r*u,e[2]=n*u,e[3]=a*u),e}},{key:"multiply",value:function(e,t,r){var n=e[0],a=e[1],u=e[2],i=e[3],o=t[0],l=t[1],s=t[2],c=t[3];return r[0]=n*c+i*o+a*s-u*l,r[1]=a*c+i*l+u*o-n*s,r[2]=u*c+i*s+n*l-a*o,r[3]=i*c-n*o-a*l-u*s,r}},{key:"rotate",value:function(e,t,r){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);if(!n)return null;var a=t[0],u=t[1],i=t[2];1!=n&&(n=1/n,a*=n,u*=n,i*=n);var o=Math.sin(.5*e);return r[0]=a*o,r[1]=u*o,r[2]=i*o,r[3]=Math.cos(.5*e),r}},{key:"toVecIII",value:function(t,r,n){var a=e.create(),u=e.create(),i=e.create();return e.inverse(r,i),a[0]=t[0],a[1]=t[1],a[2]=t[2],e.multiply(i,a,u),e.multiply(u,r,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}},{key:"toMatIV",value:function(e,t){var r=e[0],n=e[1],a=e[2],u=e[3],i=r+r,o=n+n,l=a+a,s=r*i,c=r*o,f=r*l,E=n*o,h=n*l,T=a*l,d=u*i,R=u*o,v=u*l;return t[0]=1-(E+T),t[1]=c-v,t[2]=f+R,t[3]=0,t[4]=c+v,t[5]=1-(s+T),t[6]=h-d,t[7]=0,t[8]=f-R,t[9]=h+d,t[10]=1-(s+E),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"slerp",value:function(e,t,r,n){var a=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],u=1-a*a;if(u<=0)n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3];else if(u=Math.sqrt(u),Math.abs(u)<1e-4)n[0]=.5*e[0]+.5*t[0],n[1]=.5*e[1]+.5*t[1],n[2]=.5*e[2]+.5*t[2],n[3]=.5*e[3]+.5*t[3];else{var i=Math.acos(a),o=i*r,l=Math.sin(i-o)/u,s=Math.sin(o)/u;n[0]=e[0]*l+t[0]*s,n[1]=e[1]*l+t[1]*s,n[2]=e[2]*l+t[2]*s,n[3]=e[3]*l+t[3]*s}return n}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(){function e(){n(this,e)}return a(e,null,[{key:"plane",value:function(e,t,r){var n=void 0,a=void 0;return n=e/2,a=t/2,tc=r||[1,1,1,1],{position:[-n,a,0,n,a,0,-n,-a,0,n,-a,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],color:[r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3],r[0],r[1],r[2],r[3]],texCoord:[0,0,1,0,0,1,1,1],index:[0,1,2,2,1,3]}}},{key:"torus",value:function(e,t,r,n,a){var u=void 0,i=void 0,o=[],l=[],s=[],c=[],f=[];for(u=0;u<=e;u++){var E=2*Math.PI/e*u,h=Math.cos(E),T=Math.sin(E);for(i=0;i<=t;i++){var d=2*Math.PI/t*i,R=(h*r+n)*Math.cos(d),v=T*r,g=(h*r+n)*Math.sin(d),_=h*Math.cos(d),b=h*Math.sin(d),m=1/t*i,A=1/e*u+.5;A>1&&(A-=1),A=1-A,o.push(R,v,g),l.push(_,T,b),s.push(a[0],a[1],a[2],a[3]),c.push(m,A)}}for(u=0;u<e;u++)for(i=0;i<t;i++){var y=(t+1)*u+i;f.push(y,y+t+1,y+1),f.push(y+t+1,y+t+2,y+1)}return{position:o,normal:l,color:s,texCoord:c,index:f}}},{key:"sphere",value:function(e,t,r,n){var a=void 0,u=void 0,i=[],o=[],l=[],s=[],c=[];for(a=0;a<=e;a++){var f=Math.PI/e*a,E=Math.cos(f),h=Math.sin(f);for(u=0;u<=t;u++){var T=2*Math.PI/t*u,d=h*r*Math.cos(T),R=E*r,v=h*r*Math.sin(T),g=h*Math.cos(T),_=h*Math.sin(T);i.push(d,R,v),o.push(g,E,_),l.push(n[0],n[1],n[2],n[3]),s.push(1-1/t*u,1/e*a)}}for(a=0;a<e;a++)for(u=0;u<t;u++){var b=(t+1)*a+u;c.push(b,b+1,b+t+2),c.push(b,b+t+2,b+t+1)}return{position:i,normal:o,color:l,texCoord:s,index:c}}},{key:"cube",value:function(e,t){for(var r=.5*e,n=[-r,-r,r,r,-r,r,r,r,r,-r,r,r,-r,-r,-r,-r,r,-r,r,r,-r,r,-r,-r,-r,r,-r,-r,r,r,r,r,r,r,r,-r,-r,-r,-r,r,-r,-r,r,-r,r,-r,-r,r,r,-r,-r,r,r,-r,r,r,r,r,-r,r,-r,-r,-r,-r,-r,r,-r,r,r,-r,r,-r],a=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],u=[],i=0;i<n.length/3;i++)u.push(t[0],t[1],t[2],t[3]);return{position:n,normal:a,color:u,texCoord:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],index:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]}}}]),e}();t.default=u},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function(){function e(){n(this,e)}return a(e,null,[{key:"hsva",value:function(e,t,r,n){if(!(t>1||r>1||n>1)){var a=e%360,u=Math.floor(a/60),i=a/60-u,o=r*(1-t),l=r*(1-t*i),s=r*(1-t*(1-i)),c=new Array;if(!t>0&&!t<0)c.push(r,r,r,n);else{var f=new Array(r,l,o,o,s,r),E=new Array(s,r,r,l,o,o),h=new Array(o,o,s,r,r,l);c.push(f[u],E[u],h[u],n)}return c}}},{key:"easeLiner",value:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}},{key:"easeOutCubic",value:function(e){return(e=e/1-1)*e*e+1}},{key:"easeQuintic",value:function(e){var t=(e/=1)*e;return t*e*t}}]),e}();t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=n(i),l=r(1),s=n(l),c=r(2),f=n(c),E=r(3),h=n(E),T=function(){function e(){a(this,e),this.VERSION="0.1.2",this.PI2=6.283185307179586,this.PI=3.141592653589793,this.PIH=1.5707963267948966,this.PIH2=.7853981633974483,this.TEXTURE_UNIT_COUNT=null,this.ready=!1,this.canvas=null,this.gl=null,this.textures=null,this.ext=null,this.Audio=o.default,this.Mesh=f.default,this.Util=h.default,this.Math=new s.default,console.log("%câ—†%c glcubic.js %câ—†%c : version %c"+this.VERSION,"color: crimson","","color: crimson","","color: royalblue")}return u(e,[{key:"init",value:function(e,t){var r=t||{};return this.ready=!1,null!=e&&(e instanceof HTMLCanvasElement?this.canvas=e:"[object String]"===Object.prototype.toString.call(e)&&(this.canvas=document.getElementById(e)),null!=this.canvas&&(this.gl=this.canvas.getContext("webgl",r)||this.canvas.getContext("experimental-webgl",r),null!=this.gl&&(this.ready=!0,this.TEXTURE_UNIT_COUNT=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.textures=new Array(this.TEXTURE_UNIT_COUNT)),this.ext={elementIndexUint:this.gl.getExtension("OES_element_index_uint"),textureFloat:this.gl.getExtension("OES_texture_float"),drawBuffers:this.gl.getExtension("WEBGL_draw_buffers")},this.ready))}},{key:"sceneClear",value:function(e,t,r){var n=this.gl,a=n.COLOR_BUFFER_BIT;n.clearColor(e[0],e[1],e[2],e[3]),null!=t&&(n.clearDepth(t),a|=n.DEPTH_BUFFER_BIT),null!=r&&(n.clearStencil(r),a|=n.STENCIL_BUFFER_BIT),n.clear(a)}},{key:"sceneView",value:function(e,t,r,n){var a=e||0,u=t||0,i=r||window.innerWidth,o=n||window.innerHeight;this.gl.viewport(a,u,i,o)}},{key:"drawArrays",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawArrays(e,r,t)}},{key:"drawElements",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawElements(e,t,this.gl.UNSIGNED_SHORT,r)}},{key:"drawElementsInt",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.drawElements(e,t,this.gl.UNSIGNED_INT,r)}},{key:"createVbo",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),t}}},{key:"createIbo",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Int16Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),t}}},{key:"createIboInt",value:function(e){if(null!=e){var t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(e),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),t}}},{key:"createTextureFromFile",value:function(e,t,r){var n=this;if(null!=e&&null!=t){var a=new Image,u=this.gl;a.onload=function(){n.textures[t]={texture:null,type:null,loaded:!1};var i=u.createTexture();u.bindTexture(u.TEXTURE_2D,i),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,a),u.generateMipmap(u.TEXTURE_2D),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),n.textures[t].texture=i,n.textures[t].type=u.TEXTURE_2D,n.textures[t].loaded=!0,console.log("%câ—†%c texture number: %c"+t+"%c, file loaded: %c"+e,"color: crimson","","color: blue","","color: goldenrod"),u.bindTexture(u.TEXTURE_2D,null),null!=r&&r(t)},a.src=e}}},{key:"createTextureFromObject",value:function(e,t){if(null!=e&&null!=t){var r=this.gl,n=r.createTexture();this.textures[t]={texture:null,type:null,loaded:!1},r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),this.textures[t].texture=n,this.textures[t].type=r.TEXTURE_2D,this.textures[t].loaded=!0,console.log("%câ—†%c texture number: %c"+t+"%c, object attached","color: crimson","","color: blue",""),r.bindTexture(r.TEXTURE_2D,null)}}},{key:"createTextureCubeFromFile",value:function(e,t,r,n){var a=this;if(null!=e&&null!=t&&null!=r){var u=[],i=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};for(var o=0;o<e.length;o++)u[o]={image:new Image,loaded:!1},u[o].image.onload=function(o){return function(){if(u[o].loaded=!0,6===u.length){var l=!0;if(u.map(function(e){l=l&&e.loaded}),!0===l){var s=i.createTexture();i.bindTexture(i.TEXTURE_CUBE_MAP,s);for(var c=0;c<e.length;c++)i.texImage2D(t[c],0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,u[c].image);i.generateMipmap(i.TEXTURE_CUBE_MAP),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),a.textures[r].texture=s,a.textures[r].type=i.TEXTURE_CUBE_MAP,a.textures[r].loaded=!0,console.log("%câ—†%c texture number: %c"+r+"%c, file loaded: %c"+e[0]+"...","color: crimson","","color: blue","","color: goldenrod"),i.bindTexture(i.TEXTURE_CUBE_MAP,null),null!=n&&n(r)}}}}(o),u[o].image.src=e[o]}}},{key:"bindTexture",value:function(e,t){null!=this.textures[t]&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.textures[t].type,this.textures[t].texture))}},{key:"isTextureLoaded",value:function(){var e=void 0,t=void 0,r=void 0,n=void 0;for(r=!0,n=!1,e=0,t=this.textures.length;e<t;e++)null!=this.textures[e]&&(n=!0,r=r&&this.textures[e].loaded);return!!n&&r}},{key:"createFramebuffer",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){var n=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};var a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a);var u=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,u),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,u);var i=n.createTexture();return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,i,0),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=i,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%câ—†%c texture number: %c"+r+"%c, framebuffer created","color: crimson","","color: blue",""),{framebuffer:a,depthRenderbuffer:u,texture:i}}}},{key:"createFramebufferStencil",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){var n=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};var a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a);var u=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,u),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,u);var i=n.createTexture();return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,i,0),n.bindTexture(n.TEXTURE_2D,null),n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=i,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%câ—†%c texture number: %c"+r+"%c, framebuffer created (enable stencil)","color: crimson","","color: blue",""),{framebuffer:a,depthStencilRenderbuffer:u,texture:i}}}},{key:"createFramebufferFloat",value:function(e,t,r){if(null!=e&&null!=t&&null!=r){var n=this.gl;this.textures[r]={texture:null,type:null,loaded:!1};var a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a);var u=n.createTexture();return n.bindTexture(n.TEXTURE_2D,u),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.FLOAT,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,u,0),n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),this.textures[r].texture=u,this.textures[r].type=n.TEXTURE_2D,this.textures[r].loaded=!0,console.log("%câ—†%c texture number: %c"+r+"%c, framebuffer created (enable float)","color: crimson","","color: blue",""),{framebuffer:a,depthRenderbuffer:null,texture:u}}}},{key:"createFramebufferCube",value:function(e,t,r,n){if(null!=e&&null!=t&&null!=r&&null!=n){var a=this.gl;this.textures[n]={texture:null,type:null,loaded:!1};var u=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,u);var i=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,i),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,e,t),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,i);var o=a.createTexture();a.bindTexture(a.TEXTURE_CUBE_MAP,o);for(var l=0;l<r.length;l++)a.texImage2D(r[l],0,a.RGBA,e,t,0,a.RGBA,a.UNSIGNED_BYTE,null);return a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null),this.textures[n].texture=o,this.textures[n].type=a.TEXTURE_CUBE_MAP,this.textures[n].loaded=!0,console.log("%câ—†%c texture number: %c"+n+"%c, framebuffer cube created","color: crimson","","color: blue",""),{framebuffer:u,depthRenderbuffer:i,texture:o}}}},{key:"createProgramFromId",value:function(e,t,r,n,a,u){if(null==this.gl)return null;var i=void 0,o=new d(this.gl);for(o.vs=o.createShaderFromId(e),o.fs=o.createShaderFromId(t),o.prg=o.createProgram(o.vs,o.fs),o.attL=new Array(r.length),o.attS=new Array(r.length),i=0;i<r.length;i++)o.attL[i]=this.gl.getAttribLocation(o.prg,r[i]),o.attS[i]=n[i];for(o.uniL=new Array(a.length),i=0;i<a.length;i++)o.uniL[i]=this.gl.getUniformLocation(o.prg,a[i]);return o.uniT=u,o.locationCheck(r,a),o}},{key:"createProgramFromSource",value:function(e,t,r,n,a,u){if(null==this.gl)return null;var i=void 0,o=new d(this.gl);for(o.vs=o.createShaderFromSource(e,this.gl.VERTEX_SHADER),o.fs=o.createShaderFromSource(t,this.gl.FRAGMENT_SHADER),o.prg=o.createProgram(o.vs,o.fs),o.attL=new Array(r.length),o.attS=new Array(r.length),i=0;i<r.length;i++)o.attL[i]=this.gl.getAttribLocation(o.prg,r[i]),o.attS[i]=n[i];for(o.uniL=new Array(a.length),i=0;i<a.length;i++)o.uniL[i]=this.gl.getUniformLocation(o.prg,a[i]);return o.uniT=u,o.locationCheck(r,a),o}},{key:"createProgramFromFile",value:function(e,t,r,n,a,u,i){function o(e,t){var r=new XMLHttpRequest;r.open("GET",t.targetUrl,!0),r.setRequestHeader("Pragma","no-cache"),r.setRequestHeader("Cache-Control","no-cache"),r.onload=function(){console.log("%câ—†%c shader source loaded: %c"+t.targetUrl,"color: crimson","","color: goldenrod"),t.source=r.responseText,l(e)},r.send()}function l(e){if(null!=c.vs.source&&null!=c.fs.source){var t=void 0;for(s.vs=s.createShaderFromSource(c.vs.source,e.VERTEX_SHADER),s.fs=s.createShaderFromSource(c.fs.source,e.FRAGMENT_SHADER),s.prg=s.createProgram(s.vs,s.fs),s.attL=new Array(r.length),s.attS=new Array(r.length),t=0;t<r.length;t++)s.attL[t]=e.getAttribLocation(s.prg,r[t]),s.attS[t]=n[t];for(s.uniL=new Array(a.length),t=0;t<a.length;t++)s.uniL[t]=e.getUniformLocation(s.prg,a[t]);s.uniT=u,s.locationCheck(r,a),i(s)}}if(null==this.gl)return null;var s=new d(this.gl),c={vs:{targetUrl:e,source:null},fs:{targetUrl:t,source:null}};return o(this.gl,c.vs),o(this.gl,c.fs),s}}]),e}();t.default=T;var d=function(){function e(t){a(this,e),this.gl=t,this.vs=null,this.fs=null,this.prg=null,this.attL=null,this.attS=null,this.uniL=null,this.uniT=null}return u(e,[{key:"createShaderFromId",value:function(e){var t=void 0,r=document.getElementById(e);if(r){switch(r.type){case"x-shader/x-vertex":t=this.gl.createShader(this.gl.VERTEX_SHADER);break;case"x-shader/x-fragment":t=this.gl.createShader(this.gl.FRAGMENT_SHADER);break;default:return}if(this.gl.shaderSource(t,r.text),this.gl.compileShader(t),this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS))return t;console.warn("â—† compile failed of shader: "+this.gl.getShaderInfoLog(t))}}},{key:"createShaderFromSource",value:function(e,t){var r=void 0;switch(t){case this.gl.VERTEX_SHADER:r=this.gl.createShader(this.gl.VERTEX_SHADER);break;case this.gl.FRAGMENT_SHADER:r=this.gl.createShader(this.gl.FRAGMENT_SHADER);break;default:return}if(this.gl.shaderSource(r,e),this.gl.compileShader(r),this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS))return r;console.warn("â—† compile failed of shader: "+this.gl.getShaderInfoLog(r))}},{key:"createProgram",value:function(e,t){var r=this.gl.createProgram();if(this.gl.attachShader(r,e),this.gl.attachShader(r,t),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS))return this.gl.useProgram(r),r;console.warn("â—† link program failed: "+this.gl.getProgramInfoLog(r))}},{key:"useProgram",value:function(){this.gl.useProgram(this.prg)}},{key:"setAttribute",value:function(e,t){var r=this.gl;for(var n in e)this.attL[n]>=0&&(r.bindBuffer(r.ARRAY_BUFFER,e[n]),r.enableVertexAttribArray(this.attL[n]),r.vertexAttribPointer(this.attL[n],this.attS[n],r.FLOAT,!1,0,0));null!=t&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t)}},{key:"pushShader",value:function(e){for(var t=this.gl,r=0,n=this.uniT.length;r<n;r++){var a="uniform"+this.uniT[r].replace(/matrix/i,"Matrix");null!=t[a]?-1!==a.search(/Matrix/)?t[a](this.uniL[r],!1,e[r]):t[a](this.uniL[r],e[r]):console.warn("â—† not support uniform type: "+this.uniT[r])}}},{key:"locationCheck",value:function(e,t){var r=void 0,n=void 0;for(r=0,n=e.length;r<n;r++)(null==this.attL[r]||this.attL[r]<0)&&console.warn('â—† invalid attribute location: %c"'+e[r]+'"',"color: crimson");for(r=0,n=t.length;r<n;r++)(null==this.uniL[r]||this.uniL[r]<0)&&console.warn('â—† invalid uniform location: %c"'+t[r]+'"',"color: crimson")}}]),e}();window.gl3=window.gl3||new T}]);