# samples

WebGL スクール用サンプル

## todo

説明していないこと、説明しないといけないこと

* プリミティブ形状 ○
* precision 修飾子 （GLSL ワークショップで触れる）
* モデル座標変換行列に対する適用順序に気をつけること ○ 
* ラジアンと角度の関係について言及 （GLSL ワークショップでも言及）
* カリング



* image directory は不要な場合消す（最後にまとめてやる）


## 各サンプルとドキュメントとの連動

### 001

まず動かしてみること。加えて glcubic.js を使う上での簡単な説明。

頂点についてと、さらに頂点属性について。それらを統合するプログラムオブジェクトについて。

レンダリングパイプラインと、パイプラインにおけるシェーダの概念。各シェーダの役割、gl_Position と gl_FragColor の意味。

関連して、WebGL における色のレンジを説明する。


### 002

頂点色を追加する作業を通して、拡張するために必要となる概念を身につける。

javascript 側では、頂点属性を定義するための配列の追加や、VBO の追加が必要となる。併せてストライドについても触れる。

シェーダの実装としては、まず何より attribute 修飾子が追加されることに触れ、ここでストレージ修飾子について押さえる。さらに varying 修飾子を使ってシェーダ間で連携をとるための方法についても解説する。

最終的には、javascript と各シェーダのすべての連携が大切というところを押さえるのがポイント。


### 003

インデックスバッファは使わずに、単純に頂点を 6 個使って砂時計を描画する。

基本的にシェーダの実装はそのままで、頂点定義だけを追加させる。これは次のサンプルでインデックスバッファを用いた例を解説するための布石となるサンプル。

やってみよう、の項で頂点の位置を変形して四角形にする作業を行ってもらう。

### 004

インデックスバッファを使った描画に切り替え、四角形を描画する。

ここではシェーダには手を入れない。あくまでも描画命令を切り替えることを念頭に置く。

またこの段階でプリミティブ形状について触れる。


### 005

再び砂時計の状態のサンプルを用意する。ここでは三角形がふたつ必要なので、インデックスの生成にも気をつけなければならないし、プリミティブ形状についても気をつけなくてはならないことを学ぶ。

さらに、これを三次元空間上に置かれているように変形してもらう作業をする。これの意図は、奥にあるものはパースが掛かったような効果を付加する必要があるが、それを手動で計算するのは非常に難しいということを知ってもらうため。

次のサンプルで、行列を用いた座標変換を行う必要性についてより深く理解してもらうための布石。

### 006

gl_Position に直接値を突っ込んだり、それらを手動で調整しようとしたりすると、精神が崩壊する可能性があることは 005 で理解できたはずなので、ここに行列を持ち込む。

006 では Z 軸回転を加えることによりポリゴンを回転させる。併せて、ここで uniform 修飾子付きの変数がシェーダに存在すること、またそこにデータを受け渡すための javascript の実装について理解する。

進行としては、この段階で行列のなんたるかについて行うが、まずはモデル座標変換行列を使った平行移動が適用されたサンプルを用意する。

### 007

行列の考え方に慣れるために、モデル座標変換行列における「平行移動」「回転」「拡大縮小」について踏み込んで解説する。

モデル座標変換行列以外の行列については 008 で詳しく解説するとして、007 ではまずモデル座標変換行列をしっかりと理解してもらう。

具体的には、複数のモデルを同時に描画することを同時に取得しながら、個別に異なる座標変換行列が適用されたポリゴンを描画させる。ここでは、モデル座標変換行列の適用順序によって結果が大きく変わってくるということを感じてもらう。

### 008

モデル座標変換行列以外の、ビュー、プロジェクション座標変換行列について、その必要となるパラメータの種類について知る。

併せて、ここではアニメーションを行うための概念についても理解してもらう。

### 009

メッシュ系のユーティリティの使い方を解説するとともに、ここではまず球体のモデルを描画することを目指す。

ただしこの時点では深度テストとかリングについての説明はしない。

ここはあえて失敗した状態のものを先に見せることによって、深度テストの必要性について理解してもらう。

### 010

深度テストの有効化について学ぶ。

球体モデルを深度テストを有効化して正しく描画できるようにする。

まずは素の gl で深度テストを指定する方法について解説し、それを glcubic.js なら scene_clear で一括して行ってくれる旨を解説する。


### 011

パーティクル実装の一例として、点描画について扱う。

点描画を行うための基本と、gl_PointSize の指定について扱う。

やってみようと題して、input エレメントを利用して動的に点の大きさを変更する処理を組み込む。


### 012

Canvas2D と組み合わせて、画像ファイルの画素を元に頂点を配置、これらを点描画することにチャレンジする。

もし事前に Canvas2D を扱った経験がまったくなかったとしても問題が起こらないように工夫したつもり。

このサンプルでは点は全て 1.0 サイズであり、しかも色が一律に白である。やってみようで画素の色を拾ってきて着色する。


### 013

マウスの動きに連動してカメラを動かせる仕組みを考える。

クォータニオンの最も単純な利用例として、マウスカーソルとカメラの連動を実装する。とは言え、まずはこちらで作成したものをベースに体感してもらうところまで。

やってみようでは、ここでカメラに対する知識を深めてもらうことも踏まえ、カメラの上方向や視野角などを調整していろいろ体験してもらう。








### 011

法線を用いてライティングを行うための準備その１。

法線とはなにかを説明して、さらに法線をそのまま色として出力する。


### 012

法線を用いてライティングを行うための準備その２。

法線を逆行列を使って変換し、一定の向きに固定させる。

ここでもやはり法線を色として出力することで、法線が一定の向きに固定されていることを確認する。


### 013

法線を用いてライティングを行うための準備その３。

法線の変換に、ライトベクトルの内積を用いた拡散光の計算を適用する。この時点では頂点シェーダ側で色の算出までを行う。

この段階までには光源の種類や、ライティングの種類などについて触れておく必要がある。


### 014

フラグメントシェーダによるライティングを行い、高品質な結果を得られるようにする。

ここでは前サンプルとの比較に重点を置く。


### 015

反射光と拡散光を取り入れ、フォンシェーディングを完成させる。

ここまでのどこかの段階でグーローシェーディングについても触れておく必要があるかも。


### 016

平行光源ではなく点光源について扱う。


### 017

減衰する点光源。


### 018

マウスとクォータニオンを組み合わせたカメラの操作。

### 019

点描画とライン描画。

### 020

テクスチャ

### 021

マルチテクスチャ

### 022

canvas からテクスチャ

### 023

ポイントスプライトによるパーティクル実装。

### 024

フォグ


### todo

* ベクトル
* 行列
* 法線
* ライティング（拡散・反射・環境）
* クォータニオン
* クォータニオンとマウス
* テクスチャ
* Canvas からテクスチャ
* マルチテクスチャ
* フォグ
* 正射影行列処理
* フィルタリング（グレースケール・セピア・単純なブラー）
* ガウシアンブラー
* キューブ環境マップ
* 屈折マッピング
* 射影テクスチャ
* 光学迷彩
* バンプマッピング（ヘイトマップ？）
* ラプラシアン
* ラインやドットによる陰影表現
* セルシェーディング（すべてシェーダのみでやる）
* フレームバッファ
* ゴッドレイ
* ズームブラー
* 


